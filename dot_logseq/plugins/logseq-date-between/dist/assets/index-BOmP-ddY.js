(function(){const it=document.createElement("link").relList;if(it&&it.supports&&it.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))K(W);new MutationObserver(W=>{for(const X of W)if(X.type==="childList")for(const h of X.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&K(h)}).observe(document,{childList:!0,subtree:!0});function et(W){const X={};return W.integrity&&(X.integrity=W.integrity),W.referrerPolicy&&(X.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?X.credentials="include":W.crossOrigin==="anonymous"?X.credentials="omit":X.credentials="same-origin",X}function K(W){if(W.ep)return;W.ep=!0;const X=et(W);fetch(W.href,X)}})();var Wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sn(tt){return tt&&tt.__esModule&&Object.prototype.hasOwnProperty.call(tt,"default")?tt.default:tt}var Mn={exports:{}};/*! For license information please see lsplugin.user.js.LICENSE.txt */Mn.exports;(function(tt,it){(function(et,K){tt.exports=K()})(self,()=>(()=>{var et={227:(h,u,b)=>{var M=b(155);u.formatArgs=function(D){if(D[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+D[0]+(this.useColors?"%c ":" ")+"+"+h.exports.humanize(this.diff),!this.useColors)return;const nt="color: "+this.color;D.splice(1,0,nt,"color: inherit");let v=0,p=0;D[0].replace(/%[a-zA-Z%]/g,x=>{x!=="%%"&&(v++,x==="%c"&&(p=v))}),D.splice(p,0,nt)},u.save=function(D){try{D?u.storage.setItem("debug",D):u.storage.removeItem("debug")}catch{}},u.load=function(){let D;try{D=u.storage.getItem("debug")}catch{}return!D&&M!==void 0&&"env"in M&&(D=M.env.DEBUG),D},u.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},u.storage=function(){try{return localStorage}catch{}}(),u.destroy=(()=>{let D=!1;return()=>{D||(D=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),u.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],u.log=console.debug||console.log||(()=>{}),h.exports=b(447)(u);const{formatters:C}=h.exports;C.j=function(D){try{return JSON.stringify(D)}catch(nt){return"[UnexpectedJSONParseError]: "+nt.message}}},447:(h,u,b)=>{h.exports=function(M){function C(v){let p,x,m,S=null;function w(...F){if(!w.enabled)return;const z=w,E=Number(new Date),j=E-(p||E);z.diff=j,z.prev=p,z.curr=E,p=E,F[0]=C.coerce(F[0]),typeof F[0]!="string"&&F.unshift("%O");let i=0;F[0]=F[0].replace(/%([a-zA-Z%])/g,(l,_)=>{if(l==="%%")return"%";i++;const g=C.formatters[_];if(typeof g=="function"){const Y=F[i];l=g.call(z,Y),F.splice(i,1),i--}return l}),C.formatArgs.call(z,F),(z.log||C.log).apply(z,F)}return w.namespace=v,w.useColors=C.useColors(),w.color=C.selectColor(v),w.extend=D,w.destroy=C.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(x!==C.namespaces&&(x=C.namespaces,m=C.enabled(v)),m),set:F=>{S=F}}),typeof C.init=="function"&&C.init(w),w}function D(v,p){const x=C(this.namespace+(p===void 0?":":p)+v);return x.log=this.log,x}function nt(v){return v.toString().substring(2,v.toString().length-2).replace(/\.\*\?$/,"*")}return C.debug=C,C.default=C,C.coerce=function(v){return v instanceof Error?v.stack||v.message:v},C.disable=function(){const v=[...C.names.map(nt),...C.skips.map(nt).map(p=>"-"+p)].join(",");return C.enable(""),v},C.enable=function(v){let p;C.save(v),C.namespaces=v,C.names=[],C.skips=[];const x=(typeof v=="string"?v:"").split(/[\s,]+/),m=x.length;for(p=0;p<m;p++)x[p]&&((v=x[p].replace(/\*/g,".*?"))[0]==="-"?C.skips.push(new RegExp("^"+v.slice(1)+"$")):C.names.push(new RegExp("^"+v+"$")))},C.enabled=function(v){if(v[v.length-1]==="*")return!0;let p,x;for(p=0,x=C.skips.length;p<x;p++)if(C.skips[p].test(v))return!1;for(p=0,x=C.names.length;p<x;p++)if(C.names[p].test(v))return!0;return!1},C.humanize=b(824),C.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(M).forEach(v=>{C[v]=M[v]}),C.names=[],C.skips=[],C.formatters={},C.selectColor=function(v){let p=0;for(let x=0;x<v.length;x++)p=(p<<5)-p+v.charCodeAt(x),p|=0;return C.colors[Math.abs(p)%C.colors.length]},C.enable(C.load()),C}},996:h=>{var u=function(m){return function(S){return!!S&&typeof S=="object"}(m)&&!function(S){var w=Object.prototype.toString.call(S);return w==="[object RegExp]"||w==="[object Date]"||function(F){return F.$$typeof===b}(S)}(m)},b=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.element"):60103;function M(m,S){return S.clone!==!1&&S.isMergeableObject(m)?p((w=m,Array.isArray(w)?[]:{}),m,S):m;var w}function C(m,S,w){return m.concat(S).map(function(F){return M(F,w)})}function D(m){return Object.keys(m).concat(function(S){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(S).filter(function(w){return Object.propertyIsEnumerable.call(S,w)}):[]}(m))}function nt(m,S){try{return S in m}catch{return!1}}function v(m,S,w){var F={};return w.isMergeableObject(m)&&D(m).forEach(function(z){F[z]=M(m[z],w)}),D(S).forEach(function(z){(function(E,j){return nt(E,j)&&!(Object.hasOwnProperty.call(E,j)&&Object.propertyIsEnumerable.call(E,j))})(m,z)||(nt(m,z)&&w.isMergeableObject(S[z])?F[z]=function(E,j){if(!j.customMerge)return p;var i=j.customMerge(E);return typeof i=="function"?i:p}(z,w)(m[z],S[z],w):F[z]=M(S[z],w))}),F}function p(m,S,w){(w=w||{}).arrayMerge=w.arrayMerge||C,w.isMergeableObject=w.isMergeableObject||u,w.cloneUnlessOtherwiseSpecified=M;var F=Array.isArray(S);return F===Array.isArray(m)?F?w.arrayMerge(m,S,w):v(m,S,w):M(S,w)}p.all=function(m,S){if(!Array.isArray(m))throw new Error("first argument should be an array");return m.reduce(function(w,F){return p(w,F,S)},{})};var x=p;h.exports=x},856:function(h){h.exports=function(){function u($){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},u($)}function b($,R){return b=Object.setPrototypeOf||function(V,ot){return V.__proto__=ot,V},b($,R)}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C($,R,V){return C=M()?Reflect.construct:function(ot,Mt,Ht){var Jt=[null];Jt.push.apply(Jt,Mt);var re=new(Function.bind.apply(ot,Jt));return Ht&&b(re,Ht.prototype),re},C.apply(null,arguments)}function D($){return nt($)||v($)||p($)||m()}function nt($){if(Array.isArray($))return x($)}function v($){if(typeof Symbol<"u"&&$[Symbol.iterator]!=null||$["@@iterator"]!=null)return Array.from($)}function p($,R){if($){if(typeof $=="string")return x($,R);var V=Object.prototype.toString.call($).slice(8,-1);return V==="Object"&&$.constructor&&(V=$.constructor.name),V==="Map"||V==="Set"?Array.from($):V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V)?x($,R):void 0}}function x($,R){(R==null||R>$.length)&&(R=$.length);for(var V=0,ot=new Array(R);V<R;V++)ot[V]=$[V];return ot}function m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=Object.hasOwnProperty,w=Object.setPrototypeOf,F=Object.isFrozen,z=Object.getPrototypeOf,E=Object.getOwnPropertyDescriptor,j=Object.freeze,i=Object.seal,l=Object.create,_=typeof Reflect<"u"&&Reflect,g=_.apply,Y=_.construct;g||(g=function($,R,V){return $.apply(R,V)}),j||(j=function($){return $}),i||(i=function($){return $}),Y||(Y=function($,R){return C($,D(R))});var ct=J(Array.prototype.forEach),ft=J(Array.prototype.pop),U=J(Array.prototype.push),A=J(String.prototype.toLowerCase),O=J(String.prototype.match),P=J(String.prototype.replace),H=J(String.prototype.indexOf),a=J(String.prototype.trim),d=J(RegExp.prototype.test),k=st(TypeError);function J($){return function(R){for(var V=arguments.length,ot=new Array(V>1?V-1:0),Mt=1;Mt<V;Mt++)ot[Mt-1]=arguments[Mt];return g($,R,ot)}}function st($){return function(){for(var R=arguments.length,V=new Array(R),ot=0;ot<R;ot++)V[ot]=arguments[ot];return Y($,V)}}function T($,R){w&&w($,null);for(var V=R.length;V--;){var ot=R[V];if(typeof ot=="string"){var Mt=A(ot);Mt!==ot&&(F(R)||(R[V]=Mt),ot=Mt)}$[ot]=!0}return $}function Z($){var R,V=l(null);for(R in $)g(S,$,[R])&&(V[R]=$[R]);return V}function at($,R){for(;$!==null;){var V=E($,R);if(V){if(V.get)return J(V.get);if(typeof V.value=="function")return J(V.value)}$=z($)}function ot(Mt){return console.warn("fallback value for",Mt),null}return ot}var vt=j(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_t=j(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),xt=j(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bt=j(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ut=j(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),dt=j(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),St=j(["#text"]),Tt=j(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Nt=j(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Qt=j(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$t=j(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Lt=i(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pe=i(/<%[\w\W]*|[\w\W]*%>/gm),Cn=i(/^data-[\-\w.\u00B7-\uFFFF]/),Yt=i(/^aria-[\-\w]+$/),Gt=i(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ke=i(/^(?:\w+script|data):/i),On=i(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),En=i(/^html$/i),me=function(){return typeof window>"u"?null:window},jn=function($,R){if(u($)!=="object"||typeof $.createPolicy!="function")return null;var V=null,ot="data-tt-policy-suffix";R.currentScript&&R.currentScript.hasAttribute(ot)&&(V=R.currentScript.getAttribute(ot));var Mt="dompurify"+(V?"#"+V:"");try{return $.createPolicy(Mt,{createHTML:function(Ht){return Ht}})}catch{return console.warn("TrustedTypes policy "+Mt+" could not be created."),null}};function Qe(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:me(),R=function(o){return Qe(o)};if(R.version="2.3.8",R.removed=[],!$||!$.document||$.document.nodeType!==9)return R.isSupported=!1,R;var V=$.document,ot=$.document,Mt=$.DocumentFragment,Ht=$.HTMLTemplateElement,Jt=$.Node,re=$.Element,Ye=$.NodeFilter,Xe=$.NamedNodeMap,Xt=Xe===void 0?$.NamedNodeMap||$.MozNamedAttrMap:Xe,kn=$.HTMLFormElement,An=$.DOMParser,Tn=$.trustedTypes,Oe=re.prototype,Ln=at(Oe,"cloneNode"),Dn=at(Oe,"nextSibling"),$n=at(Oe,"childNodes"),He=at(Oe,"parentNode");if(typeof Ht=="function"){var Pt=ot.createElement("template");Pt.content&&Pt.content.ownerDocument&&(ot=Pt.content.ownerDocument)}var Rt=jn(Tn,V),tn=Rt?Rt.createHTML(""):"",Ee=ot,Pe=Ee.implementation,oe=Ee.createNodeIterator,en=Ee.createDocumentFragment,nn=Ee.getElementsByTagName,In=V.importNode,rn={};try{rn=Z(ot).documentMode?ot.documentMode:{}}catch{}var It={};R.isSupported=typeof He=="function"&&Pe&&Pe.createHTMLDocument!==void 0&&rn!==9;var ge,Zt,je=Lt,ke=pe,Re=Cn,Fn=Yt,on=Ke,Ae=On,ht=Gt,Ct=null,sn=T({},[].concat(D(vt),D(_t),D(xt),D(ut),D(St))),Ot=null,ie=T({},[].concat(D(Tt),D(Nt),D(Qt),D($t))),yt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),se=null,Te=null,Ue=!0,ze=!0,an=!1,ae=!1,te=!1,qe=!1,Be=!1,ce=!1,Le=!1,le=!1,cn=!0,We=!0,ue=!1,Ut={},de=null,ln=T({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),un=null,dn=T({},["audio","video","img","source","image","track"]),Ge=null,ee=T({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fe="http://www.w3.org/1998/Math/MathML",Je="http://www.w3.org/2000/svg",Vt="http://www.w3.org/1999/xhtml",De=Vt,fn=!1,ye=["application/xhtml+xml","text/html"],ve="text/html",he=null,Nn=ot.createElement("form"),hn=function(o){return o instanceof RegExp||o instanceof Function},Ze=function(o){he&&he===o||(o&&u(o)==="object"||(o={}),o=Z(o),Ct="ALLOWED_TAGS"in o?T({},o.ALLOWED_TAGS):sn,Ot="ALLOWED_ATTR"in o?T({},o.ALLOWED_ATTR):ie,Ge="ADD_URI_SAFE_ATTR"in o?T(Z(ee),o.ADD_URI_SAFE_ATTR):ee,un="ADD_DATA_URI_TAGS"in o?T(Z(dn),o.ADD_DATA_URI_TAGS):dn,de="FORBID_CONTENTS"in o?T({},o.FORBID_CONTENTS):ln,se="FORBID_TAGS"in o?T({},o.FORBID_TAGS):{},Te="FORBID_ATTR"in o?T({},o.FORBID_ATTR):{},Ut="USE_PROFILES"in o&&o.USE_PROFILES,Ue=o.ALLOW_ARIA_ATTR!==!1,ze=o.ALLOW_DATA_ATTR!==!1,an=o.ALLOW_UNKNOWN_PROTOCOLS||!1,ae=o.SAFE_FOR_TEMPLATES||!1,te=o.WHOLE_DOCUMENT||!1,ce=o.RETURN_DOM||!1,Le=o.RETURN_DOM_FRAGMENT||!1,le=o.RETURN_TRUSTED_TYPE||!1,Be=o.FORCE_BODY||!1,cn=o.SANITIZE_DOM!==!1,We=o.KEEP_CONTENT!==!1,ue=o.IN_PLACE||!1,ht=o.ALLOWED_URI_REGEXP||ht,De=o.NAMESPACE||Vt,o.CUSTOM_ELEMENT_HANDLING&&hn(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(yt.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&hn(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(yt.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(yt.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ge=ge=ye.indexOf(o.PARSER_MEDIA_TYPE)===-1?ve:o.PARSER_MEDIA_TYPE,Zt=ge==="application/xhtml+xml"?function(N){return N}:A,ae&&(ze=!1),Le&&(ce=!0),Ut&&(Ct=T({},D(St)),Ot=[],Ut.html===!0&&(T(Ct,vt),T(Ot,Tt)),Ut.svg===!0&&(T(Ct,_t),T(Ot,Nt),T(Ot,$t)),Ut.svgFilters===!0&&(T(Ct,xt),T(Ot,Nt),T(Ot,$t)),Ut.mathMl===!0&&(T(Ct,ut),T(Ot,Qt),T(Ot,$t))),o.ADD_TAGS&&(Ct===sn&&(Ct=Z(Ct)),T(Ct,o.ADD_TAGS)),o.ADD_ATTR&&(Ot===ie&&(Ot=Z(Ot)),T(Ot,o.ADD_ATTR)),o.ADD_URI_SAFE_ATTR&&T(Ge,o.ADD_URI_SAFE_ATTR),o.FORBID_CONTENTS&&(de===ln&&(de=Z(de)),T(de,o.FORBID_CONTENTS)),We&&(Ct["#text"]=!0),te&&T(Ct,["html","head","body"]),Ct.table&&(T(Ct,["tbody"]),delete se.tbody),j&&j(o),he=o)},pn=T({},["mi","mo","mn","ms","mtext"]),mn=T({},["foreignobject","desc","title","annotation-xml"]),Yn=T({},["title","style","font","a","script"]),zt=T({},_t);T(zt,xt),T(zt,bt);var $e=T({},ut);T($e,dt);var Hn=function(o){var N=He(o);N&&N.tagName||(N={namespaceURI:Vt,tagName:"template"});var L=A(o.tagName),pt=A(N.tagName);return o.namespaceURI===Je?N.namespaceURI===Vt?L==="svg":N.namespaceURI===fe?L==="svg"&&(pt==="annotation-xml"||pn[pt]):!!zt[L]:o.namespaceURI===fe?N.namespaceURI===Vt?L==="math":N.namespaceURI===Je?L==="math"&&mn[pt]:!!$e[L]:o.namespaceURI===Vt&&!(N.namespaceURI===Je&&!mn[pt])&&!(N.namespaceURI===fe&&!pn[pt])&&!$e[L]&&(Yn[L]||!zt[L])},qt=function(o){U(R.removed,{element:o});try{o.parentNode.removeChild(o)}catch{try{o.outerHTML=tn}catch{o.remove()}}},_e=function(o,N){try{U(R.removed,{attribute:N.getAttributeNode(o),from:N})}catch{U(R.removed,{attribute:null,from:N})}if(N.removeAttribute(o),o==="is"&&!Ot[o])if(ce||Le)try{qt(N)}catch{}else try{N.setAttribute(o,"")}catch{}},gn=function(o){var N,L;if(Be)o="<remove></remove>"+o;else{var pt=O(o,/^[\r\n\t ]+/);L=pt&&pt[0]}ge==="application/xhtml+xml"&&(o='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+o+"</body></html>");var wt=Rt?Rt.createHTML(o):o;if(De===Vt)try{N=new An().parseFromString(wt,ge)}catch{}if(!N||!N.documentElement){N=Pe.createDocument(De,"template",null);try{N.documentElement.innerHTML=fn?"":wt}catch{}}var kt=N.body||N.documentElement;return o&&L&&kt.insertBefore(ot.createTextNode(L),kt.childNodes[0]||null),De===Vt?nn.call(N,te?"html":"body")[0]:te?N.documentElement:kt},yn=function(o){return oe.call(o.ownerDocument||o,o,Ye.SHOW_ELEMENT|Ye.SHOW_COMMENT|Ye.SHOW_TEXT,null,!1)},Pn=function(o){return o instanceof kn&&(typeof o.nodeName!="string"||typeof o.textContent!="string"||typeof o.removeChild!="function"||!(o.attributes instanceof Xt)||typeof o.removeAttribute!="function"||typeof o.setAttribute!="function"||typeof o.namespaceURI!="string"||typeof o.insertBefore!="function")},be=function(o){return u(Jt)==="object"?o instanceof Jt:o&&u(o)==="object"&&typeof o.nodeType=="number"&&typeof o.nodeName=="string"},At=function(o,N,L){It[o]&&ct(It[o],function(pt){pt.call(R,N,L,he)})},we=function(o){var N;if(At("beforeSanitizeElements",o,null),Pn(o)||d(/[\u0080-\uFFFF]/,o.nodeName))return qt(o),!0;var L=Zt(o.nodeName);if(At("uponSanitizeElement",o,{tagName:L,allowedTags:Ct}),o.hasChildNodes()&&!be(o.firstElementChild)&&(!be(o.content)||!be(o.content.firstElementChild))&&d(/<[/\w]/g,o.innerHTML)&&d(/<[/\w]/g,o.textContent)||L==="select"&&d(/<template/i,o.innerHTML))return qt(o),!0;if(!Ct[L]||se[L]){if(!se[L]&&ne(L)&&(yt.tagNameCheck instanceof RegExp&&d(yt.tagNameCheck,L)||yt.tagNameCheck instanceof Function&&yt.tagNameCheck(L)))return!1;if(We&&!de[L]){var pt=He(o)||o.parentNode,wt=$n(o)||o.childNodes;if(wt&&pt)for(var kt=wt.length-1;kt>=0;--kt)pt.insertBefore(Ln(wt[kt],!0),Dn(o))}return qt(o),!0}return o instanceof re&&!Hn(o)?(qt(o),!0):L!=="noscript"&&L!=="noembed"||!d(/<\/no(script|embed)/i,o.innerHTML)?(ae&&o.nodeType===3&&(N=o.textContent,N=P(N,je," "),N=P(N,ke," "),o.textContent!==N&&(U(R.removed,{element:o.cloneNode()}),o.textContent=N)),At("afterSanitizeElements",o,null),!1):(qt(o),!0)},vn=function(o,N,L){if(cn&&(N==="id"||N==="name")&&(L in ot||L in Nn))return!1;if(!(ze&&!Te[N]&&d(Re,N))){if(!(Ue&&d(Fn,N))){if(!Ot[N]||Te[N]){if(!(ne(o)&&(yt.tagNameCheck instanceof RegExp&&d(yt.tagNameCheck,o)||yt.tagNameCheck instanceof Function&&yt.tagNameCheck(o))&&(yt.attributeNameCheck instanceof RegExp&&d(yt.attributeNameCheck,N)||yt.attributeNameCheck instanceof Function&&yt.attributeNameCheck(N))||N==="is"&&yt.allowCustomizedBuiltInElements&&(yt.tagNameCheck instanceof RegExp&&d(yt.tagNameCheck,L)||yt.tagNameCheck instanceof Function&&yt.tagNameCheck(L))))return!1}else if(!Ge[N]){if(!d(ht,P(L,Ae,""))){if((N!=="src"&&N!=="xlink:href"&&N!=="href"||o==="script"||H(L,"data:")!==0||!un[o])&&!(an&&!d(on,P(L,Ae,"")))){if(L)return!1}}}}}return!0},ne=function(o){return o.indexOf("-")>0},Me=function(o){var N,L,pt,wt;At("beforeSanitizeAttributes",o,null);var kt=o.attributes;if(kt){var Et={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ot};for(wt=kt.length;wt--;){var xe=N=kt[wt],Kt=xe.name,Dt=xe.namespaceURI;if(L=Kt==="value"?N.value:a(N.value),pt=Zt(Kt),Et.attrName=pt,Et.attrValue=L,Et.keepAttr=!0,Et.forceKeepAttr=void 0,At("uponSanitizeAttribute",o,Et),L=Et.attrValue,!Et.forceKeepAttr&&(_e(Kt,o),Et.keepAttr))if(d(/\/>/i,L))_e(Kt,o);else{ae&&(L=P(L,je," "),L=P(L,ke," "));var Ve=Zt(o.nodeName);if(vn(Ve,pt,L))try{Dt?o.setAttributeNS(Dt,Kt,L):o.setAttribute(Kt,L),ft(R.removed)}catch{}}}At("afterSanitizeAttributes",o,null)}},Rn=function o(N){var L,pt=yn(N);for(At("beforeSanitizeShadowDOM",N,null);L=pt.nextNode();)At("uponSanitizeShadowNode",L,null),we(L)||(L.content instanceof Mt&&o(L.content),Me(L));At("afterSanitizeShadowDOM",N,null)};return R.sanitize=function(o,N){var L,pt,wt,kt,Et;if((fn=!o)&&(o="<!-->"),typeof o!="string"&&!be(o)){if(typeof o.toString!="function")throw k("toString is not a function");if(typeof(o=o.toString())!="string")throw k("dirty is not a string, aborting")}if(!R.isSupported){if(u($.toStaticHTML)==="object"||typeof $.toStaticHTML=="function"){if(typeof o=="string")return $.toStaticHTML(o);if(be(o))return $.toStaticHTML(o.outerHTML)}return o}if(qe||Ze(N),R.removed=[],typeof o=="string"&&(ue=!1),ue){if(o.nodeName){var xe=Zt(o.nodeName);if(!Ct[xe]||se[xe])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof Jt)(pt=(L=gn("<!---->")).ownerDocument.importNode(o,!0)).nodeType===1&&pt.nodeName==="BODY"||pt.nodeName==="HTML"?L=pt:L.appendChild(pt);else{if(!ce&&!ae&&!te&&o.indexOf("<")===-1)return Rt&&le?Rt.createHTML(o):o;if(!(L=gn(o)))return ce?null:le?tn:""}L&&Be&&qt(L.firstChild);for(var Kt=yn(ue?o:L);wt=Kt.nextNode();)wt.nodeType===3&&wt===kt||we(wt)||(wt.content instanceof Mt&&Rn(wt.content),Me(wt),kt=wt);if(kt=null,ue)return o;if(ce){if(Le)for(Et=en.call(L.ownerDocument);L.firstChild;)Et.appendChild(L.firstChild);else Et=L;return Ot.shadowroot&&(Et=In.call(V,Et,!0)),Et}var Dt=te?L.outerHTML:L.innerHTML;return te&&Ct["!doctype"]&&L.ownerDocument&&L.ownerDocument.doctype&&L.ownerDocument.doctype.name&&d(En,L.ownerDocument.doctype.name)&&(Dt="<!DOCTYPE "+L.ownerDocument.doctype.name+`>
`+Dt),ae&&(Dt=P(Dt,je," "),Dt=P(Dt,ke," ")),Rt&&le?Rt.createHTML(Dt):Dt},R.setConfig=function(o){Ze(o),qe=!0},R.clearConfig=function(){he=null,qe=!1},R.isValidAttribute=function(o,N,L){he||Ze({});var pt=Zt(o),wt=Zt(N);return vn(pt,wt,L)},R.addHook=function(o,N){typeof N=="function"&&(It[o]=It[o]||[],U(It[o],N))},R.removeHook=function(o){if(It[o])return ft(It[o])},R.removeHooks=function(o){It[o]&&(It[o]=[])},R.removeAllHooks=function(){It={}},R}return Qe()}()},729:h=>{var u=Object.prototype.hasOwnProperty,b="~";function M(){}function C(p,x,m){this.fn=p,this.context=x,this.once=m||!1}function D(p,x,m,S,w){if(typeof m!="function")throw new TypeError("The listener must be a function");var F=new C(m,S||p,w),z=b?b+x:x;return p._events[z]?p._events[z].fn?p._events[z]=[p._events[z],F]:p._events[z].push(F):(p._events[z]=F,p._eventsCount++),p}function nt(p,x){--p._eventsCount==0?p._events=new M:delete p._events[x]}function v(){this._events=new M,this._eventsCount=0}Object.create&&(M.prototype=Object.create(null),new M().__proto__||(b=!1)),v.prototype.eventNames=function(){var p,x,m=[];if(this._eventsCount===0)return m;for(x in p=this._events)u.call(p,x)&&m.push(b?x.slice(1):x);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(p)):m},v.prototype.listeners=function(p){var x=b?b+p:p,m=this._events[x];if(!m)return[];if(m.fn)return[m.fn];for(var S=0,w=m.length,F=new Array(w);S<w;S++)F[S]=m[S].fn;return F},v.prototype.listenerCount=function(p){var x=b?b+p:p,m=this._events[x];return m?m.fn?1:m.length:0},v.prototype.emit=function(p,x,m,S,w,F){var z=b?b+p:p;if(!this._events[z])return!1;var E,j,i=this._events[z],l=arguments.length;if(i.fn){switch(i.once&&this.removeListener(p,i.fn,void 0,!0),l){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,x),!0;case 3:return i.fn.call(i.context,x,m),!0;case 4:return i.fn.call(i.context,x,m,S),!0;case 5:return i.fn.call(i.context,x,m,S,w),!0;case 6:return i.fn.call(i.context,x,m,S,w,F),!0}for(j=1,E=new Array(l-1);j<l;j++)E[j-1]=arguments[j];i.fn.apply(i.context,E)}else{var _,g=i.length;for(j=0;j<g;j++)switch(i[j].once&&this.removeListener(p,i[j].fn,void 0,!0),l){case 1:i[j].fn.call(i[j].context);break;case 2:i[j].fn.call(i[j].context,x);break;case 3:i[j].fn.call(i[j].context,x,m);break;case 4:i[j].fn.call(i[j].context,x,m,S);break;default:if(!E)for(_=1,E=new Array(l-1);_<l;_++)E[_-1]=arguments[_];i[j].fn.apply(i[j].context,E)}}return!0},v.prototype.on=function(p,x,m){return D(this,p,x,m,!1)},v.prototype.once=function(p,x,m){return D(this,p,x,m,!0)},v.prototype.removeListener=function(p,x,m,S){var w=b?b+p:p;if(!this._events[w])return this;if(!x)return nt(this,w),this;var F=this._events[w];if(F.fn)F.fn!==x||S&&!F.once||m&&F.context!==m||nt(this,w);else{for(var z=0,E=[],j=F.length;z<j;z++)(F[z].fn!==x||S&&!F[z].once||m&&F[z].context!==m)&&E.push(F[z]);E.length?this._events[w]=E.length===1?E[0]:E:nt(this,w)}return this},v.prototype.removeAllListeners=function(p){var x;return p?(x=b?b+p:p,this._events[x]&&nt(this,x)):(this._events=new M,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=b,v.EventEmitter=v,h.exports=v},717:h=>{typeof Object.create=="function"?h.exports=function(u,b){u.super_=b,u.prototype=Object.create(b.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}})}:h.exports=function(u,b){u.super_=b;var M=function(){};M.prototype=b.prototype,u.prototype=new M,u.prototype.constructor=u}},824:h=>{var u=1e3,b=60*u,M=60*b,C=24*M,D=7*C,nt=365.25*C;function v(p,x,m,S){var w=x>=1.5*m;return Math.round(p/m)+" "+S+(w?"s":"")}h.exports=function(p,x){x=x||{};var m=typeof p;if(m==="string"&&p.length>0)return function(S){if(!((S=String(S)).length>100)){var w=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(S);if(w){var F=parseFloat(w[1]);switch((w[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return F*nt;case"weeks":case"week":case"w":return F*D;case"days":case"day":case"d":return F*C;case"hours":case"hour":case"hrs":case"hr":case"h":return F*M;case"minutes":case"minute":case"mins":case"min":case"m":return F*b;case"seconds":case"second":case"secs":case"sec":case"s":return F*u;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return F;default:return}}}}(p);if(m==="number"&&isFinite(p))return x.long?function(S){var w=Math.abs(S);return w>=C?v(S,w,C,"day"):w>=M?v(S,w,M,"hour"):w>=b?v(S,w,b,"minute"):w>=u?v(S,w,u,"second"):S+" ms"}(p):function(S){var w=Math.abs(S);return w>=C?Math.round(S/C)+"d":w>=M?Math.round(S/M)+"h":w>=b?Math.round(S/b)+"m":w>=u?Math.round(S/u)+"s":S+"ms"}(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))}},520:(h,u,b)=>{var M=b(155),C=M.platform==="win32",D=b(539);function nt(i,l){for(var _=[],g=0;g<i.length;g++){var Y=i[g];Y&&Y!=="."&&(Y===".."?_.length&&_[_.length-1]!==".."?_.pop():l&&_.push(".."):_.push(Y))}return _}function v(i){for(var l=i.length-1,_=0;_<=l&&!i[_];_++);for(var g=l;g>=0&&!i[g];g--);return _===0&&g===l?i:_>g?[]:i.slice(_,g+1)}var p=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,x=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,m={};function S(i){var l=p.exec(i),_=(l[1]||"")+(l[2]||""),g=l[3]||"",Y=x.exec(g);return[_,Y[1],Y[2],Y[3]]}function w(i){var l=p.exec(i),_=l[1]||"",g=!!_&&_[1]!==":";return{device:_,isUnc:g,isAbsolute:g||!!l[2],tail:l[3]}}function F(i){return"\\\\"+i.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}m.resolve=function(){for(var i="",l="",_=!1,g=arguments.length-1;g>=-1;g--){var Y;if(g>=0?Y=arguments[g]:i?(Y=M.env["="+i])&&Y.substr(0,3).toLowerCase()===i.toLowerCase()+"\\"||(Y=i+"\\"):Y=M.cwd(),!D.isString(Y))throw new TypeError("Arguments to path.resolve must be strings");if(Y){var ct=w(Y),ft=ct.device,U=ct.isUnc,A=ct.isAbsolute,O=ct.tail;if((!ft||!i||ft.toLowerCase()===i.toLowerCase())&&(i||(i=ft),_||(l=O+"\\"+l,_=A),i&&_))break}}return U&&(i=F(i)),i+(_?"\\":"")+(l=nt(l.split(/[\\\/]+/),!_).join("\\"))||"."},m.normalize=function(i){var l=w(i),_=l.device,g=l.isUnc,Y=l.isAbsolute,ct=l.tail,ft=/[\\\/]$/.test(ct);return(ct=nt(ct.split(/[\\\/]+/),!Y).join("\\"))||Y||(ct="."),ct&&ft&&(ct+="\\"),g&&(_=F(_)),_+(Y?"\\":"")+ct},m.isAbsolute=function(i){return w(i).isAbsolute},m.join=function(){for(var i=[],l=0;l<arguments.length;l++){var _=arguments[l];if(!D.isString(_))throw new TypeError("Arguments to path.join must be strings");_&&i.push(_)}var g=i.join("\\");return/^[\\\/]{2}[^\\\/]/.test(i[0])||(g=g.replace(/^[\\\/]{2,}/,"\\")),m.normalize(g)},m.relative=function(i,l){i=m.resolve(i),l=m.resolve(l);for(var _=i.toLowerCase(),g=l.toLowerCase(),Y=v(l.split("\\")),ct=v(_.split("\\")),ft=v(g.split("\\")),U=Math.min(ct.length,ft.length),A=U,O=0;O<U;O++)if(ct[O]!==ft[O]){A=O;break}if(A==0)return l;var P=[];for(O=A;O<ct.length;O++)P.push("..");return(P=P.concat(Y.slice(A))).join("\\")},m._makeLong=function(i){if(!D.isString(i))return i;if(!i)return"";var l=m.resolve(i);return/^[a-zA-Z]\:\\/.test(l)?"\\\\?\\"+l:/^\\\\[^?.]/.test(l)?"\\\\?\\UNC\\"+l.substring(2):i},m.dirname=function(i){var l=S(i),_=l[0],g=l[1];return _||g?(g&&(g=g.substr(0,g.length-1)),_+g):"."},m.basename=function(i,l){var _=S(i)[2];return l&&_.substr(-1*l.length)===l&&(_=_.substr(0,_.length-l.length)),_},m.extname=function(i){return S(i)[3]},m.format=function(i){if(!D.isObject(i))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof i);var l=i.root||"";if(!D.isString(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof i.root);var _=i.dir,g=i.base||"";return _?_[_.length-1]===m.sep?_+g:_+m.sep+g:g},m.parse=function(i){if(!D.isString(i))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof i);var l=S(i);if(!l||l.length!==4)throw new TypeError("Invalid path '"+i+"'");return{root:l[0],dir:l[0]+l[1].slice(0,-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},m.sep="\\",m.delimiter=";";var z=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,E={};function j(i){return z.exec(i).slice(1)}E.resolve=function(){for(var i="",l=!1,_=arguments.length-1;_>=-1&&!l;_--){var g=_>=0?arguments[_]:M.cwd();if(!D.isString(g))throw new TypeError("Arguments to path.resolve must be strings");g&&(i=g+"/"+i,l=g[0]==="/")}return(l?"/":"")+(i=nt(i.split("/"),!l).join("/"))||"."},E.normalize=function(i){var l=E.isAbsolute(i),_=i&&i[i.length-1]==="/";return(i=nt(i.split("/"),!l).join("/"))||l||(i="."),i&&_&&(i+="/"),(l?"/":"")+i},E.isAbsolute=function(i){return i.charAt(0)==="/"},E.join=function(){for(var i="",l=0;l<arguments.length;l++){var _=arguments[l];if(!D.isString(_))throw new TypeError("Arguments to path.join must be strings");_&&(i+=i?"/"+_:_)}return E.normalize(i)},E.relative=function(i,l){i=E.resolve(i).substr(1),l=E.resolve(l).substr(1);for(var _=v(i.split("/")),g=v(l.split("/")),Y=Math.min(_.length,g.length),ct=Y,ft=0;ft<Y;ft++)if(_[ft]!==g[ft]){ct=ft;break}var U=[];for(ft=ct;ft<_.length;ft++)U.push("..");return(U=U.concat(g.slice(ct))).join("/")},E._makeLong=function(i){return i},E.dirname=function(i){var l=j(i),_=l[0],g=l[1];return _||g?(g&&(g=g.substr(0,g.length-1)),_+g):"."},E.basename=function(i,l){var _=j(i)[2];return l&&_.substr(-1*l.length)===l&&(_=_.substr(0,_.length-l.length)),_},E.extname=function(i){return j(i)[3]},E.format=function(i){if(!D.isObject(i))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof i);var l=i.root||"";if(!D.isString(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof i.root);return(i.dir?i.dir+E.sep:"")+(i.base||"")},E.parse=function(i){if(!D.isString(i))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof i);var l=j(i);if(!l||l.length!==4)throw new TypeError("Invalid path '"+i+"'");return l[1]=l[1]||"",l[2]=l[2]||"",l[3]=l[3]||"",{root:l[0],dir:l[0]+l[1].slice(0,-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},E.sep="/",E.delimiter=":",h.exports=C?m:E,h.exports.posix=E,h.exports.win32=m},155:h=>{var u,b,M=h.exports={};function C(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function nt(E){if(u===setTimeout)return setTimeout(E,0);if((u===C||!u)&&setTimeout)return u=setTimeout,setTimeout(E,0);try{return u(E,0)}catch{try{return u.call(null,E,0)}catch{return u.call(this,E,0)}}}(function(){try{u=typeof setTimeout=="function"?setTimeout:C}catch{u=C}try{b=typeof clearTimeout=="function"?clearTimeout:D}catch{b=D}})();var v,p=[],x=!1,m=-1;function S(){x&&v&&(x=!1,v.length?p=v.concat(p):m=-1,p.length&&w())}function w(){if(!x){var E=nt(S);x=!0;for(var j=p.length;j;){for(v=p,p=[];++m<j;)v&&v[m].run();m=-1,j=p.length}v=null,x=!1,function(i){if(b===clearTimeout)return clearTimeout(i);if((b===D||!b)&&clearTimeout)return b=clearTimeout,clearTimeout(i);try{b(i)}catch{try{return b.call(null,i)}catch{return b.call(this,i)}}}(E)}}function F(E,j){this.fun=E,this.array=j}function z(){}M.nextTick=function(E){var j=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)j[i-1]=arguments[i];p.push(new F(E,j)),p.length!==1||x||nt(w)},F.prototype.run=function(){this.fun.apply(null,this.array)},M.title="browser",M.browser=!0,M.env={},M.argv=[],M.version="",M.versions={},M.on=z,M.addListener=z,M.once=z,M.off=z,M.removeListener=z,M.removeAllListeners=z,M.emit=z,M.prependListener=z,M.prependOnceListener=z,M.listeners=function(E){return[]},M.binding=function(E){throw new Error("process.binding is not supported")},M.cwd=function(){return"/"},M.chdir=function(E){throw new Error("process.chdir is not supported")},M.umask=function(){return 0}},384:h=>{h.exports=function(u){return u&&typeof u=="object"&&typeof u.copy=="function"&&typeof u.fill=="function"&&typeof u.readUInt8=="function"}},539:(h,u,b)=>{var M=b(155),C=/%[sdj%]/g;u.format=function(a){if(!i(a)){for(var d=[],k=0;k<arguments.length;k++)d.push(v(arguments[k]));return d.join(" ")}k=1;for(var J=arguments,st=J.length,T=String(a).replace(C,function(at){if(at==="%%")return"%";if(k>=st)return at;switch(at){case"%s":return String(J[k++]);case"%d":return Number(J[k++]);case"%j":try{return JSON.stringify(J[k++])}catch{return"[Circular]"}default:return at}}),Z=J[k];k<st;Z=J[++k])E(Z)||!g(Z)?T+=" "+Z:T+=" "+v(Z);return T},u.deprecate=function(a,d){if(l(b.g.process))return function(){return u.deprecate(a,d).apply(this,arguments)};if(M.noDeprecation===!0)return a;var k=!1;return function(){if(!k){if(M.throwDeprecation)throw new Error(d);M.traceDeprecation?console.trace(d):console.error(d),k=!0}return a.apply(this,arguments)}};var D,nt={};function v(a,d){var k={seen:[],stylize:x};return arguments.length>=3&&(k.depth=arguments[2]),arguments.length>=4&&(k.colors=arguments[3]),z(d)?k.showHidden=d:d&&u._extend(k,d),l(k.showHidden)&&(k.showHidden=!1),l(k.depth)&&(k.depth=2),l(k.colors)&&(k.colors=!1),l(k.customInspect)&&(k.customInspect=!0),k.colors&&(k.stylize=p),m(k,a,k.depth)}function p(a,d){var k=v.styles[d];return k?"\x1B["+v.colors[k][0]+"m"+a+"\x1B["+v.colors[k][1]+"m":a}function x(a,d){return a}function m(a,d,k){if(a.customInspect&&d&&ft(d.inspect)&&d.inspect!==u.inspect&&(!d.constructor||d.constructor.prototype!==d)){var J=d.inspect(k,a);return i(J)||(J=m(a,J,k)),J}var st=function(ut,dt){if(l(dt))return ut.stylize("undefined","undefined");if(i(dt)){var St="'"+JSON.stringify(dt).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ut.stylize(St,"string")}if(j(dt))return ut.stylize(""+dt,"number");if(z(dt))return ut.stylize(""+dt,"boolean");if(E(dt))return ut.stylize("null","null")}(a,d);if(st)return st;var T=Object.keys(d),Z=function(ut){var dt={};return ut.forEach(function(St,Tt){dt[St]=!0}),dt}(T);if(a.showHidden&&(T=Object.getOwnPropertyNames(d)),ct(d)&&(T.indexOf("message")>=0||T.indexOf("description")>=0))return S(d);if(T.length===0){if(ft(d)){var at=d.name?": "+d.name:"";return a.stylize("[Function"+at+"]","special")}if(_(d))return a.stylize(RegExp.prototype.toString.call(d),"regexp");if(Y(d))return a.stylize(Date.prototype.toString.call(d),"date");if(ct(d))return S(d)}var vt,_t="",xt=!1,bt=["{","}"];return F(d)&&(xt=!0,bt=["[","]"]),ft(d)&&(_t=" [Function"+(d.name?": "+d.name:"")+"]"),_(d)&&(_t=" "+RegExp.prototype.toString.call(d)),Y(d)&&(_t=" "+Date.prototype.toUTCString.call(d)),ct(d)&&(_t=" "+S(d)),T.length!==0||xt&&d.length!=0?k<0?_(d)?a.stylize(RegExp.prototype.toString.call(d),"regexp"):a.stylize("[Object]","special"):(a.seen.push(d),vt=xt?function(ut,dt,St,Tt,Nt){for(var Qt=[],$t=0,Lt=dt.length;$t<Lt;++$t)H(dt,String($t))?Qt.push(w(ut,dt,St,Tt,String($t),!0)):Qt.push("");return Nt.forEach(function(pe){pe.match(/^\d+$/)||Qt.push(w(ut,dt,St,Tt,pe,!0))}),Qt}(a,d,k,Z,T):T.map(function(ut){return w(a,d,k,Z,ut,xt)}),a.seen.pop(),function(ut,dt,St){return ut.reduce(function(Tt,Nt){return Nt.indexOf(`
`)>=0,Tt+Nt.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?St[0]+(dt===""?"":dt+`
 `)+" "+ut.join(`,
  `)+" "+St[1]:St[0]+dt+" "+ut.join(", ")+" "+St[1]}(vt,_t,bt)):bt[0]+_t+bt[1]}function S(a){return"["+Error.prototype.toString.call(a)+"]"}function w(a,d,k,J,st,T){var Z,at,vt;if((vt=Object.getOwnPropertyDescriptor(d,st)||{value:d[st]}).get?at=vt.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):vt.set&&(at=a.stylize("[Setter]","special")),H(J,st)||(Z="["+st+"]"),at||(a.seen.indexOf(vt.value)<0?(at=E(k)?m(a,vt.value,null):m(a,vt.value,k-1)).indexOf(`
`)>-1&&(at=T?at.split(`
`).map(function(_t){return"  "+_t}).join(`
`).substr(2):`
`+at.split(`
`).map(function(_t){return"   "+_t}).join(`
`)):at=a.stylize("[Circular]","special")),l(Z)){if(T&&st.match(/^\d+$/))return at;(Z=JSON.stringify(""+st)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Z=Z.substr(1,Z.length-2),Z=a.stylize(Z,"name")):(Z=Z.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Z=a.stylize(Z,"string"))}return Z+": "+at}function F(a){return Array.isArray(a)}function z(a){return typeof a=="boolean"}function E(a){return a===null}function j(a){return typeof a=="number"}function i(a){return typeof a=="string"}function l(a){return a===void 0}function _(a){return g(a)&&U(a)==="[object RegExp]"}function g(a){return typeof a=="object"&&a!==null}function Y(a){return g(a)&&U(a)==="[object Date]"}function ct(a){return g(a)&&(U(a)==="[object Error]"||a instanceof Error)}function ft(a){return typeof a=="function"}function U(a){return Object.prototype.toString.call(a)}function A(a){return a<10?"0"+a.toString(10):a.toString(10)}u.debuglog=function(a){if(l(D)&&(D=M.env.NODE_DEBUG||""),a=a.toUpperCase(),!nt[a])if(new RegExp("\\b"+a+"\\b","i").test(D)){var d=M.pid;nt[a]=function(){var k=u.format.apply(u,arguments);console.error("%s %d: %s",a,d,k)}}else nt[a]=function(){};return nt[a]},u.inspect=v,v.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},v.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},u.isArray=F,u.isBoolean=z,u.isNull=E,u.isNullOrUndefined=function(a){return a==null},u.isNumber=j,u.isString=i,u.isSymbol=function(a){return typeof a=="symbol"},u.isUndefined=l,u.isRegExp=_,u.isObject=g,u.isDate=Y,u.isError=ct,u.isFunction=ft,u.isPrimitive=function(a){return a===null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||typeof a=="symbol"||a===void 0},u.isBuffer=b(384);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var a=new Date,d=[A(a.getHours()),A(a.getMinutes()),A(a.getSeconds())].join(":");return[a.getDate(),O[a.getMonth()],d].join(" ")}function H(a,d){return Object.prototype.hasOwnProperty.call(a,d)}u.log=function(){console.log("%s - %s",P(),u.format.apply(u,arguments))},u.inherits=b(717),u._extend=function(a,d){if(!d||!g(d))return a;for(var k=Object.keys(d),J=k.length;J--;)a[k[J]]=d[k[J]];return a}}},K={};function W(h){var u=K[h];if(u!==void 0)return u.exports;var b=K[h]={exports:{}};return et[h].call(b.exports,b,b.exports,W),b.exports}W.n=h=>{var u=h&&h.__esModule?()=>h.default:()=>h;return W.d(u,{a:u}),u},W.d=(h,u)=>{for(var b in u)W.o(u,b)&&!W.o(h,b)&&Object.defineProperty(h,b,{enumerable:!0,get:u[b]})},W.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),W.o=(h,u)=>Object.prototype.hasOwnProperty.call(h,u),W.r=h=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})};var X={};return(()=>{W.r(X),W.d(X,{LSPluginUser:()=>Zn,setupPluginUserInstance:()=>br});var h=W(520),u=(W(856),W(996)),b=W.n(u),M=function(){return M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},M.apply(this,arguments)};function C(e){return e.toLowerCase()}var D=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],nt=/[^A-Z0-9]+/gi;function v(e,t,n){return t instanceof RegExp?e.replace(t,n):t.reduce(function(r,s){return r.replace(s,n)},e)}function p(e,t){return t===void 0&&(t={}),function(n,r){r===void 0&&(r={});for(var s=r.splitRegexp,c=s===void 0?D:s,f=r.stripRegexp,y=f===void 0?nt:f,I=r.transform,B=I===void 0?C:I,G=r.delimiter,q=G===void 0?" ":G,Q=v(v(n,c,"$1\0$2"),y,"\0"),lt=0,rt=Q.length;Q.charAt(lt)==="\0";)lt++;for(;Q.charAt(rt-1)==="\0";)rt--;return Q.slice(lt,rt).split("\0").map(B).join(q)}(e,M({delimiter:"."},t))}var x=W(729),m=W.n(x);function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const w=navigator.platform.toLowerCase()==="win32"?h.win32:h.posix,F=function(e,t){return t===void 0&&(t={}),p(e,M({delimiter:"_"},t))};class z extends m(){constructor(t,n){super(),S(this,"_tag",void 0),S(this,"_opts",void 0),S(this,"_logs",[]),this._tag=t,this._opts=n}write(t,n,r){var s;n!=null&&n.length&&n[n.length-1]===!0&&(r=!0,n.pop());const c=n.reduce((y,I)=>(I&&I instanceof Error?y+=`${I.message} ${I.stack}`:y+=I.toString(),y),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var f;this._logs.push([t,c]),(r||(s=this._opts)!==null&&s!==void 0&&s.console)&&((f=console)===null||f===void 0||f[t==="ERROR"?"error":"debug"](`${t}: ${c}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...t){this.write("INFO",t)}error(...t){this.write("ERROR",t)}warn(...t){this.write("WARN",t)}setTag(t){this._tag=t}toJSON(){return this._logs}}function E(e,...t){try{const n=new URL(e);if(!n.origin)throw new Error(null);const r=w.join(e.substr(n.origin.length),...t);return n.origin+r}catch{return w.join(e,...t)}}function j(e,t){let n,r,s=!1;const c=y=>I=>{e&&clearTimeout(e),y(I),s=!0},f=new Promise((y,I)=>{n=c(y),r=c(I),e&&(e=setTimeout(()=>r(new Error(`[deferred timeout] ${t}`)),e))});return{created:Date.now(),setTag:y=>t=y,resolve:n,reject:r,promise:f,get settled(){return s}}}const i=new Map;window.__injectedUIEffects=i;var l=W(227),_=W.n(l);function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Y="application/x-postmate-v1+json";let ct=0;const ft={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},U=(e,t)=>(typeof t!="string"||e.origin===t)&&!!e.data&&(typeof e.data!="object"||"postmate"in e.data)&&e.data.type===Y&&!!ft[e.data.postmate];class A{constructor(t){g(this,"parent",void 0),g(this,"frame",void 0),g(this,"child",void 0),g(this,"events",{}),g(this,"childOrigin",void 0),g(this,"listener",void 0),this.parent=t.parent,this.frame=t.frame,this.child=t.child,this.childOrigin=t.childOrigin,this.listener=n=>{if(!U(n,this.childOrigin))return!1;const{data:r,name:s}=((n||{}).data||{}).value||{};n.data.postmate==="emit"&&s in this.events&&this.events[s].forEach(c=>{c.call(this,r)})},this.parent.addEventListener("message",this.listener,!1)}get(t,...n){return new Promise((r,s)=>{const c=++ct,f=y=>{y.data.uid===c&&y.data.postmate==="reply"&&(this.parent.removeEventListener("message",f,!1),y.data.error?s(y.data.error):r(y.data.value))};this.parent.addEventListener("message",f,!1),this.child.postMessage({postmate:"request",type:Y,property:t,args:n,uid:c},this.childOrigin)})}call(t,n){this.child.postMessage({postmate:"call",type:Y,property:t,data:n},this.childOrigin)}on(t,n){this.events[t]||(this.events[t]=[]),this.events[t].push(n)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class O{constructor(t){g(this,"model",void 0),g(this,"parent",void 0),g(this,"parentOrigin",void 0),g(this,"child",void 0),this.model=t.model,this.parent=t.parent,this.parentOrigin=t.parentOrigin,this.child=t.child,this.child.addEventListener("message",n=>{if(!U(n,this.parentOrigin))return;const{property:r,uid:s,data:c,args:f}=n.data;n.data.postmate!=="call"?((y,I,B)=>{const G=typeof y[I]=="function"?y[I].apply(null,B):y[I];return Promise.resolve(G)})(this.model,r,f).then(y=>{n.source.postMessage({property:r,postmate:"reply",type:Y,uid:s,value:y},n.origin)}).catch(y=>{n.source.postMessage({property:r,postmate:"reply",type:Y,uid:s,error:y},n.origin)}):r in this.model&&typeof this.model[r]=="function"&&this.model[r](c)})}emit(t,n){this.parent.postMessage({postmate:"emit",type:Y,value:{name:t,data:n}},this.parentOrigin)}}class P{constructor(t){g(this,"container",void 0),g(this,"parent",void 0),g(this,"frame",void 0),g(this,"child",void 0),g(this,"childOrigin",void 0),g(this,"url",void 0),g(this,"model",void 0),this.container=t.container,this.url=t.url,this.parent=window,this.frame=document.createElement("iframe"),t.id&&(this.frame.id=t.id),t.name&&(this.frame.name=t.name),this.frame.classList.add.apply(this.frame.classList,t.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=t.model||{}}sendHandshake(t){const n=(c=>{const f=document.createElement("a");f.href=c;const y=f.protocol.length>4?f.protocol:window.location.protocol,I=f.host.length?f.port==="80"||f.port==="443"?f.hostname:f.host:window.location.host;return f.origin||`${y}//${I}`})(t=t||this.url);let r,s=0;return new Promise((c,f)=>{const y=B=>!!U(B,n)&&(B.data.postmate==="handshake-reply"?(clearInterval(r),this.parent.removeEventListener("message",y,!1),this.childOrigin=B.origin,c(new A(this))):f("Failed handshake"));this.parent.addEventListener("message",y,!1);const I=()=>{s++,this.child.postMessage({postmate:"handshake",type:Y,model:this.model},n),s===5&&clearInterval(r)};this.frame.addEventListener("load",()=>{I(),r=setInterval(I,500)}),this.frame.src=t})}destroy(){this.frame.parentNode.removeChild(this.frame)}}g(P,"debug",!1),g(P,"Model",void 0);class H{constructor(t){g(this,"child",void 0),g(this,"model",void 0),g(this,"parent",void 0),g(this,"parentOrigin",void 0),this.child=window,this.model=t,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((t,n)=>{const r=s=>{if(s.data.postmate){if(s.data.postmate==="handshake"){this.child.removeEventListener("message",r,!1),s.source.postMessage({postmate:"handshake-reply",type:Y},s.origin),this.parentOrigin=s.origin;const c=s.data.model;return c&&Object.keys(c).forEach(f=>{this.model[f]=c[f]}),t(new O(this))}return n("Handshake Reply Failed")}};this.child.addEventListener("message",r,!1)})}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const{importHTML:d,createSandboxContainer:k}=window.QSandbox||{};function J(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise(async(n,r)=>{try{const s=await window.apis.doAction(["readFile",e]);n({text:()=>s})}catch(s){console.error(s),r(s)}}))}class st extends m(){constructor(t){super(),a(this,"_pluginLocal",void 0),a(this,"_frame",void 0),a(this,"_root",void 0),a(this,"_loaded",!1),a(this,"_unmountFns",[]),this._pluginLocal=t,t._dispose(()=>{this._unmount()})}async load(){const{name:t,entry:n}=this._pluginLocal.options;if(this.loaded||!n)return;const{template:r,execScripts:s}=await d(n,{fetch:J});this._mount(r,document.body);const c=k(t,{elementGetter:()=>{var y;return(y=this._root)===null||y===void 0?void 0:y.firstChild}}).instance.proxy;c.__shadow_mode__=!0,c.LSPluginLocal=this._pluginLocal,c.LSPluginShadow=this,c.LSPluginUser=c.logseq=new Zn(this._pluginLocal.toJSON(),this._pluginLocal.caller);const f=await s(c,!0);this._unmountFns.push(f.unmount),this._loaded=!0}_mount(t,n){const r=this._frame=document.createElement("div");r.classList.add("lsp-shadow-sandbox"),r.id=this._pluginLocal.id,this._root=r.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${t}</div>`,n.appendChild(r),this.emit("mounted")}_unmount(){for(const t of this._unmountFns)t&&t.call(null)}destroy(){var t,n;(t=this.frame)===null||t===void 0||(n=t.parentNode)===null||n===void 0||n.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var t;return(t=this._root)===null||t===void 0?void 0:t.firstChild}get frame(){return this._frame}}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Z=_()("LSPlugin:caller"),at="#await#response#",vt="#lspmsg#",_t="#lspmsg#error#",xt=e=>`#lspmsg#${e}`;class bt extends m(){constructor(t){super(),T(this,"_pluginLocal",void 0),T(this,"_connected",!1),T(this,"_parent",void 0),T(this,"_child",void 0),T(this,"_shadow",void 0),T(this,"_status",void 0),T(this,"_userModel",{}),T(this,"_call",void 0),T(this,"_callUserModel",void 0),T(this,"_debugTag",""),this._pluginLocal=t,t&&(this._debugTag=t.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:t}=this._pluginLocal;t?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(t={}){if(this._connected)return;const n=this,r=this._pluginLocal!=null;let s=0;const c=new Map,f=j(6e4),y=this._extendUserModel({"#lspmsg#ready#":async G=>{y[xt(G==null?void 0:G.pid)]=({type:q,payload:Q})=>{Z(`[host (_call) -> *user] ${this._debugTag}`,q,Q),n.emit(q,Q)},await f.resolve()},"#lspmsg#beforeunload#":async G=>{const q=j(1e4);n.emit("beforeunload",Object.assign({actor:q},G)),await q.promise},"#lspmsg#settings#":async({type:G,payload:q})=>{n.emit("settings:changed",q)},[vt]:async({ns:G,type:q,payload:Q})=>{Z(`[host (async) -> *user] ${this._debugTag} ns=${G} type=${q}`,Q),G&&G.startsWith("hook")?n.emit(`${G}:${q}`,Q):n.emit(q,Q)},"#lspmsg#reply#":({_sync:G,result:q})=>{if(Z(`[sync host -> *user] #${G}`,q),c.has(G)){const Q=c.get(G);Q&&(q!=null&&q.hasOwnProperty(_t)?Q.reject(q[_t]):Q.resolve(q),c.delete(G))}},...t});var I;if(r)return await f.promise,JSON.parse(JSON.stringify((I=this._pluginLocal)===null||I===void 0?void 0:I.toJSON()));const B=new H(y).sendHandshakeReply();return this._status="pending",await B.then(G=>{this._child=G,this._connected=!0,this._call=async(q,Q={},lt)=>{if(lt){const rt=++s;c.set(rt,lt),Q._sync=rt,lt.setTag(`async call #${rt}`),Z(`async call #${rt}`)}return G.emit(xt(y.baseInfo.id),{type:q,payload:Q}),lt==null?void 0:lt.promise},this._callUserModel=async(q,Q)=>{try{y[q](Q)}catch{Z(`[model method] #${q} not existed`)}},setInterval(()=>{if(c.size>100)for(const[q,Q]of c)Q.settled&&c.delete(q)},18e5)}).finally(()=>{this._status=void 0}),await f.promise,y.baseInfo}async call(t,n={}){var r;return(r=this._call)===null||r===void 0?void 0:r.call(this,t,n)}async callAsync(t,n={}){var r;const s=j(1e4);return(r=this._call)===null||r===void 0?void 0:r.call(this,t,n,s)}async callUserModel(t,...n){var r;return(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[t,...n])}async callUserModelAsync(t,...n){var r;return t=`${at}${t}`,(r=this._callUserModel)===null||r===void 0?void 0:r.apply(this,[t,...n])}async _setupIframeSandbox(){const t=this._pluginLocal,n=t.id,r=`${n}_lsp_main`,s=new URL(t.options.entry);s.searchParams.set("__v__",t.options.version);const c=document.querySelector(`#${r}`);c&&c.parentElement.removeChild(c);const f=document.createElement("div");f.classList.add("lsp-iframe-sandbox-container"),f.id=r,f.dataset.pid=n;try{var y;const q=(y=await this._pluginLocal._loadLayoutsData())===null||y===void 0?void 0:y.$$0;if(q){f.dataset.inited_layout="true";let{width:Q,height:lt,left:rt,top:mt,vw:gt,vh:jt}=q;rt=Math.max(rt,0),rt=typeof gt=="number"?`${Math.min(100*rt/gt,99)}%`:`${rt}px`,mt=Math.max(mt,45),mt=typeof jt=="number"?`${Math.min(100*mt/jt,99)}%`:`${mt}px`,Object.assign(f.style,{width:Q+"px",height:lt+"px",left:rt,top:mt})}}catch(q){console.error("[Restore Layout Error]",q)}document.body.appendChild(f);const I=new P({id:n+"_iframe",container:f,url:s.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(t.toJSON()))}});let B,G=I.sendHandshake();return this._status="pending",new Promise((q,Q)=>{B=setTimeout(()=>{Q(new Error("handshake Timeout")),I.destroy()},4e3),G.then(lt=>{this._parent=lt,this._connected=!0,this.emit("connected"),lt.on(xt(t.id),({type:rt,payload:mt})=>{var gt,jt;Z("[user -> *host] ",rt,mt),(gt=this._pluginLocal)===null||gt===void 0||gt.emit(rt,mt||{}),(jt=this._pluginLocal)===null||jt===void 0||jt.caller.emit(rt,mt||{})}),this._call=async(...rt)=>{await lt.call(xt(t.id),{type:rt[0],payload:Object.assign(rt[1]||{},{$$pid:t.id})})},this._callUserModel=async(rt,...mt)=>{if(rt.startsWith(at))return await lt.get(rt.replace(at,""),...mt);lt.call(rt,mt==null?void 0:mt[0])},q(null)}).catch(lt=>{Q(lt)}).finally(()=>{clearTimeout(B)})}).catch(q=>{throw Z("[iframe sandbox] error",q),q}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){const t=this._pluginLocal,n=this._shadow=new st(t);try{this._status="pending",await n.load(),this._connected=!0,this.emit("connected"),this._call=async(r,s={},c)=>{var f;return c&&(s.actor=c),(f=this._pluginLocal)===null||f===void 0||f.emit(r,Object.assign(s,{$$pid:t.id})),c==null?void 0:c.promise},this._callUserModel=async(...r)=>{var s;let c=r[0];(s=c)!==null&&s!==void 0&&s.startsWith(at)&&(c=c.replace(at,""));const f=r[1]||{},y=this._userModel[c];typeof y=="function"&&await y.call(null,f)}}catch(r){throw Z("[shadow sandbox] error",r),r}finally{this._status=void 0}}_extendUserModel(t){return Object.assign(this._userModel,t)}_getSandboxIframeContainer(){var t;return(t=this._parent)===null||t===void 0?void 0:t.frame.parentNode}_getSandboxShadowContainer(){var t;return(t=this._shadow)===null||t===void 0?void 0:t.frame.parentNode}_getSandboxIframeRoot(){var t;return(t=this._parent)===null||t===void 0?void 0:t.frame}_getSandboxShadowRoot(){var t;return(t=this._shadow)===null||t===void 0?void 0:t.frame}set debugTag(t){this._debugTag=t}async destroy(){var t;let n=null;this._parent&&(n=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(n=this._getSandboxShadowContainer(),this._shadow.destroy()),(t=n)===null||t===void 0||t.parentNode.removeChild(n)}}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dt{constructor(t,n){ut(this,"ctx",void 0),ut(this,"opts",void 0),this.ctx=t,this.opts=n}get ctxId(){return this.ctx.baseInfo.id}setItem(t,n){var r;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,t,n,(r=this.opts)===null||r===void 0?void 0:r.assets]})}getItem(t){var n;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,t,(n=this.opts)===null||n===void 0?void 0:n.assets]})}removeItem(t){var n;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,t,(n=this.opts)===null||n===void 0?void 0:n.assets]})}allKeys(){var t;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(t=this.opts)===null||t===void 0?void 0:t.assets]})}clear(){var t;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(t=this.opts)===null||t===void 0?void 0:t.assets]})}hasItem(t){var n;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,t,(n=this.opts)===null||n===void 0?void 0:n.assets]})}}class St{constructor(t){var n,r,s;s=void 0,(r="ctx")in(n=this)?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,this.ctx=t}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(t,...n){var r,s;const c=this.ensureHostScope();return t=(r=F(t))===null||r===void 0?void 0:r.toLowerCase(),(s=c.logseq.api["exper_"+t])===null||s===void 0?void 0:s.apply(c,n)}async loadScripts(...t){(t=t.map(n=>n!=null&&n.startsWith("http")?n:this.ctx.resolveResourceFullUrl(n))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...t)}registerFencedCodeRenderer(t,n){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,t,n)}registerExtensionsEnhancer(t,n){const r=this.ensureHostScope();return t==="katex"&&r.katex&&n(r.katex).catch(console.error),r.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,t,n)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Nt=e=>`task_callback_${e}`;class Qt{constructor(t,n,r={}){Tt(this,"_client",void 0),Tt(this,"_requestId",void 0),Tt(this,"_requestOptions",void 0),Tt(this,"_promise",void 0),Tt(this,"_aborted",!1),this._client=t,this._requestId=n,this._requestOptions=r,this._promise=new Promise((y,I)=>{if(!this._requestId)return I(null);this._client.once(Nt(this._requestId),B=>{B&&B instanceof Error?I(B):y(B)})});const{success:s,fail:c,final:f}=this._requestOptions;this._promise.then(y=>{s==null||s(y)}).catch(y=>{c==null||c(y)}).finally(()=>{f==null||f()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class $t extends x.EventEmitter{constructor(t){super(),Tt(this,"_ctx",void 0),this._ctx=t,this.ctx.caller.on("#lsp#request#callback",n=>{const r=n==null?void 0:n.requestId;r&&this.emit(Nt(r),n==null?void 0:n.payload)})}static createRequestTask(t,n,r){return new Qt(t,n,r)}async _request(t){const n=this.ctx.baseInfo.id,{success:r,fail:s,final:c,...f}=t,y=this.ctx.Experiments.invokeExperMethod("request",n,f),I=$t.createRequestTask(this.ctx.Request,y,t);return f.abortable?I:I.promise}get ctx(){return this._ctx}}const Lt=Array.isArray,pe=typeof Wt=="object"&&Wt&&Wt.Object===Object&&Wt;var Cn=typeof self=="object"&&self&&self.Object===Object&&self;const Yt=pe||Cn||Function("return this")(),Gt=Yt.Symbol;var Ke=Object.prototype,On=Ke.hasOwnProperty,En=Ke.toString,me=Gt?Gt.toStringTag:void 0;const jn=function(e){var t=On.call(e,me),n=e[me];try{e[me]=void 0;var r=!0}catch{}var s=En.call(e);return r&&(t?e[me]=n:delete e[me]),s};var Qe=Object.prototype.toString;const $=function(e){return Qe.call(e)};var R=Gt?Gt.toStringTag:void 0;const V=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":R&&R in Object(e)?jn(e):$(e)},ot=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},Mt=function(e){if(!ot(e))return!1;var t=V(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},Ht=Yt["__core-js_shared__"];var Jt,re=(Jt=/[^.]+$/.exec(Ht&&Ht.keys&&Ht.keys.IE_PROTO||""))?"Symbol(src)_1."+Jt:"";const Ye=function(e){return!!re&&re in e};var Xe=Function.prototype.toString;const Xt=function(e){if(e!=null){try{return Xe.call(e)}catch{}try{return e+""}catch{}}return""};var kn=/^\[object .+?Constructor\]$/,An=Function.prototype,Tn=Object.prototype,Oe=An.toString,Ln=Tn.hasOwnProperty,Dn=RegExp("^"+Oe.call(Ln).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const $n=function(e){return!(!ot(e)||Ye(e))&&(Mt(e)?Dn:kn).test(Xt(e))},He=function(e,t){return e==null?void 0:e[t]},Pt=function(e,t){var n=He(e,t);return $n(n)?n:void 0},Rt=function(){try{var e=Pt(Object,"defineProperty");return e({},"",{}),e}catch{}}(),tn=function(e,t,n){t=="__proto__"&&Rt?Rt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Ee=function(e){return function(t,n,r){for(var s=-1,c=Object(t),f=r(t),y=f.length;y--;){var I=f[e?y:++s];if(n(c[I],I,c)===!1)break}return t}}(),Pe=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},oe=function(e){return e!=null&&typeof e=="object"},en=function(e){return oe(e)&&V(e)=="[object Arguments]"};var nn=Object.prototype,In=nn.hasOwnProperty,rn=nn.propertyIsEnumerable;const It=en(function(){return arguments}())?en:function(e){return oe(e)&&In.call(e,"callee")&&!rn.call(e,"callee")},ge=function(){return!1};var Zt=it&&!it.nodeType&&it,je=Zt&&!0&&tt&&!tt.nodeType&&tt,ke=je&&je.exports===Zt?Yt.Buffer:void 0;const Re=(ke?ke.isBuffer:void 0)||ge;var Fn=/^(?:0|[1-9]\d*)$/;const on=function(e,t){var n=typeof e;return!!(t=t??9007199254740991)&&(n=="number"||n!="symbol"&&Fn.test(e))&&e>-1&&e%1==0&&e<t},Ae=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991};var ht={};ht["[object Float32Array]"]=ht["[object Float64Array]"]=ht["[object Int8Array]"]=ht["[object Int16Array]"]=ht["[object Int32Array]"]=ht["[object Uint8Array]"]=ht["[object Uint8ClampedArray]"]=ht["[object Uint16Array]"]=ht["[object Uint32Array]"]=!0,ht["[object Arguments]"]=ht["[object Array]"]=ht["[object ArrayBuffer]"]=ht["[object Boolean]"]=ht["[object DataView]"]=ht["[object Date]"]=ht["[object Error]"]=ht["[object Function]"]=ht["[object Map]"]=ht["[object Number]"]=ht["[object Object]"]=ht["[object RegExp]"]=ht["[object Set]"]=ht["[object String]"]=ht["[object WeakMap]"]=!1;const Ct=function(e){return oe(e)&&Ae(e.length)&&!!ht[V(e)]},sn=function(e){return function(t){return e(t)}};var Ot=it&&!it.nodeType&&it,ie=Ot&&!0&&tt&&!tt.nodeType&&tt,yt=ie&&ie.exports===Ot&&pe.process,se=function(){try{var e=ie&&ie.require&&ie.require("util").types;return e||yt&&yt.binding&&yt.binding("util")}catch{}}(),Te=se&&se.isTypedArray;const Ue=Te?sn(Te):Ct;var ze=Object.prototype.hasOwnProperty;const an=function(e,t){var n=Lt(e),r=!n&&It(e),s=!n&&!r&&Re(e),c=!n&&!r&&!s&&Ue(e),f=n||r||s||c,y=f?Pe(e.length,String):[],I=y.length;for(var B in e)!t&&!ze.call(e,B)||f&&(B=="length"||s&&(B=="offset"||B=="parent")||c&&(B=="buffer"||B=="byteLength"||B=="byteOffset")||on(B,I))||y.push(B);return y};var ae=Object.prototype;const te=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||ae)},qe=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object);var Be=Object.prototype.hasOwnProperty;const ce=function(e){if(!te(e))return qe(e);var t=[];for(var n in Object(e))Be.call(e,n)&&n!="constructor"&&t.push(n);return t},Le=function(e){return e!=null&&Ae(e.length)&&!Mt(e)},le=function(e){return Le(e)?an(e):ce(e)},cn=function(e,t){return e&&Ee(e,t,le)},We=function(){this.__data__=[],this.size=0},ue=function(e,t){return e===t||e!=e&&t!=t},Ut=function(e,t){for(var n=e.length;n--;)if(ue(e[n][0],t))return n;return-1};var de=Array.prototype.splice;const ln=function(e){var t=this.__data__,n=Ut(t,e);return!(n<0)&&(n==t.length-1?t.pop():de.call(t,n,1),--this.size,!0)},un=function(e){var t=this.__data__,n=Ut(t,e);return n<0?void 0:t[n][1]},dn=function(e){return Ut(this.__data__,e)>-1},Ge=function(e,t){var n=this.__data__,r=Ut(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function ee(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ee.prototype.clear=We,ee.prototype.delete=ln,ee.prototype.get=un,ee.prototype.has=dn,ee.prototype.set=Ge;const fe=ee,Je=function(){this.__data__=new fe,this.size=0},Vt=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},De=function(e){return this.__data__.get(e)},fn=function(e){return this.__data__.has(e)},ye=Pt(Yt,"Map"),ve=Pt(Object,"create"),he=function(){this.__data__=ve?ve(null):{},this.size=0},Nn=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var hn=Object.prototype.hasOwnProperty;const Ze=function(e){var t=this.__data__;if(ve){var n=t[e];return n==="__lodash_hash_undefined__"?void 0:n}return hn.call(t,e)?t[e]:void 0};var pn=Object.prototype.hasOwnProperty;const mn=function(e){var t=this.__data__;return ve?t[e]!==void 0:pn.call(t,e)},Yn=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ve&&t===void 0?"__lodash_hash_undefined__":t,this};function zt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}zt.prototype.clear=he,zt.prototype.delete=Nn,zt.prototype.get=Ze,zt.prototype.has=mn,zt.prototype.set=Yn;const $e=zt,Hn=function(){this.size=0,this.__data__={hash:new $e,map:new(ye||fe),string:new $e}},qt=function(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null},_e=function(e,t){var n=e.__data__;return qt(t)?n[typeof t=="string"?"string":"hash"]:n.map},gn=function(e){var t=_e(this,e).delete(e);return this.size-=t?1:0,t},yn=function(e){return _e(this,e).get(e)},Pn=function(e){return _e(this,e).has(e)},be=function(e,t){var n=_e(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function At(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}At.prototype.clear=Hn,At.prototype.delete=gn,At.prototype.get=yn,At.prototype.has=Pn,At.prototype.set=be;const we=At,vn=function(e,t){var n=this.__data__;if(n instanceof fe){var r=n.__data__;if(!ye||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new we(r)}return n.set(e,t),this.size=n.size,this};function ne(e){var t=this.__data__=new fe(e);this.size=t.size}ne.prototype.clear=Je,ne.prototype.delete=Vt,ne.prototype.get=De,ne.prototype.has=fn,ne.prototype.set=vn;const Me=ne,Rn=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},o=function(e){return this.__data__.has(e)};function N(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new we;++t<n;)this.add(e[t])}N.prototype.add=N.prototype.push=Rn,N.prototype.has=o;const L=N,pt=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},wt=function(e,t){return e.has(t)},kt=function(e,t,n,r,s,c){var f=1&n,y=e.length,I=t.length;if(y!=I&&!(f&&I>y))return!1;var B=c.get(e),G=c.get(t);if(B&&G)return B==t&&G==e;var q=-1,Q=!0,lt=2&n?new L:void 0;for(c.set(e,t),c.set(t,e);++q<y;){var rt=e[q],mt=t[q];if(r)var gt=f?r(mt,rt,q,t,e,c):r(rt,mt,q,e,t,c);if(gt!==void 0){if(gt)continue;Q=!1;break}if(lt){if(!pt(t,function(jt,Ft){if(!wt(lt,Ft)&&(rt===jt||s(rt,jt,n,r,c)))return lt.push(Ft)})){Q=!1;break}}else if(rt!==mt&&!s(rt,mt,n,r,c)){Q=!1;break}}return c.delete(e),c.delete(t),Q},Et=Yt.Uint8Array,xe=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r,s){n[++t]=[s,r]}),n},Kt=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n};var Dt=Gt?Gt.prototype:void 0,Ve=Dt?Dt.valueOf:void 0;const Vn=function(e,t,n,r,s,c,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!c(new Et(e),new Et(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ue(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var y=xe;case"[object Set]":var I=1&r;if(y||(y=Kt),e.size!=t.size&&!I)return!1;var B=f.get(e);if(B)return B==t;r|=2,f.set(e,t);var G=kt(y(e),y(t),r,s,c,f);return f.delete(e),G;case"[object Symbol]":if(Ve)return Ve.call(e)==Ve.call(t)}return!1},Or=function(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e},Er=function(e,t,n){var r=t(e);return Lt(e)?r:Or(r,n(e))},jr=function(e,t){for(var n=-1,r=e==null?0:e.length,s=0,c=[];++n<r;){var f=e[n];t(f,n,e)&&(c[s++]=f)}return c},kr=function(){return[]};var Ar=Object.prototype.propertyIsEnumerable,Kn=Object.getOwnPropertySymbols;const Tr=Kn?function(e){return e==null?[]:(e=Object(e),jr(Kn(e),function(t){return Ar.call(e,t)}))}:kr,Qn=function(e){return Er(e,le,Tr)};var Lr=Object.prototype.hasOwnProperty;const Dr=function(e,t,n,r,s,c){var f=1&n,y=Qn(e),I=y.length;if(I!=Qn(t).length&&!f)return!1;for(var B=I;B--;){var G=y[B];if(!(f?G in t:Lr.call(t,G)))return!1}var q=c.get(e),Q=c.get(t);if(q&&Q)return q==t&&Q==e;var lt=!0;c.set(e,t),c.set(t,e);for(var rt=f;++B<I;){var mt=e[G=y[B]],gt=t[G];if(r)var jt=f?r(gt,mt,G,t,e,c):r(mt,gt,G,e,t,c);if(!(jt===void 0?mt===gt||s(mt,gt,n,r,c):jt)){lt=!1;break}rt||(rt=G=="constructor")}if(lt&&!rt){var Ft=e.constructor,Ce=t.constructor;Ft==Ce||!("constructor"in e)||!("constructor"in t)||typeof Ft=="function"&&Ft instanceof Ft&&typeof Ce=="function"&&Ce instanceof Ce||(lt=!1)}return c.delete(e),c.delete(t),lt},Un=Pt(Yt,"DataView"),zn=Pt(Yt,"Promise"),qn=Pt(Yt,"Set"),Bn=Pt(Yt,"WeakMap");var Xn="[object Map]",tr="[object Promise]",er="[object Set]",nr="[object WeakMap]",rr="[object DataView]",$r=Xt(Un),Ir=Xt(ye),Fr=Xt(zn),Nr=Xt(qn),Yr=Xt(Bn),Se=V;(Un&&Se(new Un(new ArrayBuffer(1)))!=rr||ye&&Se(new ye)!=Xn||zn&&Se(zn.resolve())!=tr||qn&&Se(new qn)!=er||Bn&&Se(new Bn)!=nr)&&(Se=function(e){var t=V(e),n=t=="[object Object]"?e.constructor:void 0,r=n?Xt(n):"";if(r)switch(r){case $r:return rr;case Ir:return Xn;case Fr:return tr;case Nr:return er;case Yr:return nr}return t});const or=Se;var ir="[object Arguments]",sr="[object Array]",_n="[object Object]",ar=Object.prototype.hasOwnProperty;const Hr=function(e,t,n,r,s,c){var f=Lt(e),y=Lt(t),I=f?sr:or(e),B=y?sr:or(t),G=(I=I==ir?_n:I)==_n,q=(B=B==ir?_n:B)==_n,Q=I==B;if(Q&&Re(e)){if(!Re(t))return!1;f=!0,G=!1}if(Q&&!G)return c||(c=new Me),f||Ue(e)?kt(e,t,n,r,s,c):Vn(e,t,I,n,r,s,c);if(!(1&n)){var lt=G&&ar.call(e,"__wrapped__"),rt=q&&ar.call(t,"__wrapped__");if(lt||rt){var mt=lt?e.value():e,gt=rt?t.value():t;return c||(c=new Me),s(mt,gt,n,r,c)}}return!!Q&&(c||(c=new Me),Dr(e,t,n,r,s,c))},cr=function e(t,n,r,s,c){return t===n||(t==null||n==null||!oe(t)&&!oe(n)?t!=t&&n!=n:Hr(t,n,r,s,e,c))},Pr=function(e,t,n,r){var s=n.length,c=s,f=!r;if(e==null)return!c;for(e=Object(e);s--;){var y=n[s];if(f&&y[2]?y[1]!==e[y[0]]:!(y[0]in e))return!1}for(;++s<c;){var I=(y=n[s])[0],B=e[I],G=y[1];if(f&&y[2]){if(B===void 0&&!(I in e))return!1}else{var q=new Me;if(r)var Q=r(B,G,I,e,t,q);if(!(Q===void 0?cr(G,B,3,r,q):Q))return!1}}return!0},lr=function(e){return e==e&&!ot(e)},Rr=function(e){for(var t=le(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,lr(s)]}return t},ur=function(e,t){return function(n){return n!=null&&n[e]===t&&(t!==void 0||e in Object(n))}},Ur=function(e){var t=Rr(e);return t.length==1&&t[0][2]?ur(t[0][0],t[0][1]):function(n){return n===e||Pr(n,e,t)}},Wn=function(e){return typeof e=="symbol"||oe(e)&&V(e)=="[object Symbol]"};var zr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qr=/^\w*$/;const Gn=function(e,t){if(Lt(e))return!1;var n=typeof e;return!(n!="number"&&n!="symbol"&&n!="boolean"&&e!=null&&!Wn(e))||qr.test(e)||!zr.test(e)||t!=null&&e in Object(t)};function Jn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],c=n.cache;if(c.has(s))return c.get(s);var f=e.apply(this,r);return n.cache=c.set(s,f)||c,f};return n.cache=new(Jn.Cache||we),n}Jn.Cache=we;const Br=Jn;var Wr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gr=/\\(\\)?/g;const Jr=function(e){var t=Br(e,function(r){return n.size===500&&n.clear(),r}),n=t.cache;return t}(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Wr,function(n,r,s,c){t.push(s?c.replace(Gr,"$1"):r||n)}),t}),Zr=function(e,t){for(var n=-1,r=e==null?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s};var dr=Gt?Gt.prototype:void 0,fr=dr?dr.toString:void 0;const Vr=function e(t){if(typeof t=="string")return t;if(Lt(t))return Zr(t,e)+"";if(Wn(t))return fr?fr.call(t):"";var n=t+"";return n=="0"&&1/t==-1/0?"-0":n},Kr=function(e){return e==null?"":Vr(e)},hr=function(e,t){return Lt(e)?e:Gn(e,t)?[e]:Jr(Kr(e))},bn=function(e){if(typeof e=="string"||Wn(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t},pr=function(e,t){for(var n=0,r=(t=hr(t,e)).length;e!=null&&n<r;)e=e[bn(t[n++])];return n&&n==r?e:void 0},Qr=function(e,t,n){var r=e==null?void 0:pr(e,t);return r===void 0?n:r},Xr=function(e,t){return e!=null&&t in Object(e)},to=function(e,t,n){for(var r=-1,s=(t=hr(t,e)).length,c=!1;++r<s;){var f=bn(t[r]);if(!(c=e!=null&&n(e,f)))break;e=e[f]}return c||++r!=s?c:!!(s=e==null?0:e.length)&&Ae(s)&&on(f,s)&&(Lt(e)||It(e))},eo=function(e,t){return e!=null&&to(e,t,Xr)},no=function(e,t){return Gn(e)&&lr(t)?ur(bn(e),t):function(n){var r=Qr(n,e);return r===void 0&&r===t?eo(n,e):cr(t,r,3)}},ro=function(e){return e},oo=function(e){return function(t){return t==null?void 0:t[e]}},io=function(e){return function(t){return pr(t,e)}},so=function(e){return Gn(e)?oo(bn(e)):io(e)},ao=function(e){return typeof e=="function"?e:e==null?ro:typeof e=="object"?Lt(e)?no(e[0],e[1]):Ur(e):so(e)},co=function(e,t){var n={};return t=ao(t),cn(e,function(r,s,c){tn(n,t(r,s,c),r)}),n};function mr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lo{constructor(t,n){mr(this,"ctx",void 0),mr(this,"serviceHooks",void 0),this.ctx=t,this.serviceHooks=n,t._execCallableAPI("register-search-service",t.baseInfo.id,n.name,n.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:r=>(Lt(r==null?void 0:r.blocks)&&(r.blocks=r.blocks.map(s=>s&&co(s,(c,f)=>`block/${f}`))),r)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([r,s])=>{const c=(f=>`service:search:${f}:${n.name}`)(r);t.caller.on(c,async f=>{if(Mt(n==null?void 0:n[s.f])){let y=null;try{y=await n[s.f].apply(n,(s.args||[]).map(I=>{if(f){if(I===!0)return f;if(f.hasOwnProperty(I)){const B=f[I];return delete f[I],B}}})),s.transformOutput&&(y=s.transformOutput(y))}catch(I){console.error("[SearchService] ",I),y=I}finally{s.reply&&t.caller.call(`${c}:reply`,y)}}})})}}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const uo=Symbol.for("proxy-continue"),fo=_()("LSPlugin:user"),gr=new z("",{console:!0});function Ie(e,t,n){var r;const{key:s,label:c,desc:f,palette:y,keybinding:I,extras:B}=t;if(typeof n!="function")return this.logger.error(`${s||c}: command action should be function.`),!1;const G=function(Q){if(typeof Q=="string")return Q.trim().replace(/\s/g,"_").toLowerCase()}(s);if(!G)return this.logger.error(`${c}: command key is required.`),!1;const q=`SimpleCommandHook${G}${++_r}`;this.Editor["on"+q](n),(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:G,label:c,type:e,desc:f,keybinding:I,extras:B},["editor/hook",q]],y]})}function yr(e){return!(typeof(t=e)!="string"||t.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(t))||(gr.error(`#${e} is not a valid UUID string.`),!1);var t}let wn=null,vr=new Map;const ho={async getInfo(e){return wn||(wn=await this._execCallableAPIAsync("get-app-info")),typeof e=="string"?wn[e]:wn},registerCommand:Ie,registerSearchService(e){if(vr.has(e.name))throw new Error(`SearchService: #${e.name} has registered!`);vr.set(e.name,new lo(this,e))},registerCommandPalette(e,t){const{key:n,label:r,keybinding:s}=e;return Ie.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:s},t)},registerCommandShortcut(e,t,n={}){typeof e=="string"&&(e={mode:"global",binding:e});const{binding:r}=e,s="$shortcut$",c=n.key||s+F(r==null?void 0:r.toString());return Ie.call(this,s,{...n,key:c,palette:!1,keybinding:e},t)},registerUIItem(e,t){var n;const r=this.baseInfo.id;(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-ui-item",args:[r,e,t]})},registerPageMenuItem(e,t){if(typeof t!="function")return!1;const n=e+"_"+this.baseInfo.id,r=e;Ie.call(this,"page-menu-item",{key:n,label:r},t)},onBlockRendererSlotted(e,t){if(!yr(e))return;const n=this.baseInfo.id,r=`hook:editor:${F(`slot:${e}`)}`;return this.caller.on(r,t),this.App._installPluginHook(n,r),()=>{this.caller.off(r,t),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(e,...t){var n;if(!(e=(n=e)===null||n===void 0?void 0:n.trim()))return;let[r,s]=e.split(".");if(!["models","commands"].includes(s==null?void 0:s.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const c=e.replace(`${r}.${s}.`,"");if(!r||!s||!c)throw new Error(`Illegal type of #${e} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,s.toLowerCase(),c,t)},setFullScreen(e){const t=(...n)=>this._callWin("setFullScreen",...n);e==="toggle"?this._callWin("isFullScreen").then(n=>{n?t():t(!0)}):e?t(!0):t()}};let _r=0;const po={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(e,t){var n;fo("Register slash command #",this.baseInfo.id,e,t),typeof t=="function"&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map(r=>{const[s,...c]=r;if(s==="editor/hook"){let f=c[0],y=()=>{var B;(B=this.caller)===null||B===void 0||B.callUserModel(f)};typeof f=="function"&&(y=f);const I=`SlashCommandHook${s}${++_r}`;r[1]=I,this.Editor["on"+I](y)}return r}),(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if(typeof t!="function")return!1;const n=e+"_"+this.baseInfo.id;Ie.call(this,"block-context-menu-item",{key:n,label:e},t)},registerHighlightContextMenuItem(e,t,n){if(typeof t!="function")return!1;const r=e+"_"+this.baseInfo.id;Ie.call(this,"highlight-context-menu-item",{key:r,label:e,extras:n},t)},scrollToBlockInPage(e,t,n){const r="block-content-"+t;n!=null&&n.replaceState?this.App.replaceState("page",{name:e},{anchor:r}):this.App.pushState("page",{name:e},{anchor:r})}},mo={onBlockChanged(e,t){if(!yr(e))return;const n=this.baseInfo.id,r=`hook:db:${F(`block:${e}`)}`,s=({block:c,txData:f,txMeta:y})=>{c.uuid===e&&t(c,f,y)};return this.caller.on(r,s),this.App._installPluginHook(n,r),()=>{this.caller.off(r,s),this.App._uninstallPluginHook(n,r)}},datascriptQuery(e,...t){return t.pop(),t!=null&&t.some(n=>typeof n=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(e,...t):this._execCallableAPIAsync("datascript_query",e,...t)}},go={},yo={},vo={makeSandboxStorage(){return new dt(this,{assets:!0})}};class Zn extends m(){constructor(t,n){super(),Bt(this,"_baseInfo",void 0),Bt(this,"_caller",void 0),Bt(this,"_version","0.0.17"),Bt(this,"_debugTag",""),Bt(this,"_settingsSchema",void 0),Bt(this,"_connected",!1),Bt(this,"_ui",new Map),Bt(this,"_mFileStorage",void 0),Bt(this,"_mRequest",void 0),Bt(this,"_mExperiments",void 0),Bt(this,"_beforeunloadCallback",void 0),this._baseInfo=t,this._caller=n,n.on("sys:ui:visible",r=>{r!=null&&r.toggle&&this.toggleMainUI()}),n.on("settings:changed",r=>{const s=Object.assign({},this.settings),c=Object.assign(this._baseInfo.settings,r);this.emit("settings:changed",{...c},s)}),n.on("beforeunload",async r=>{const{actor:s,...c}=r,f=this._beforeunloadCallback;try{f&&await f(c),s==null||s.resolve(null)}catch(y){this.logger.error("[beforeunload] ",y),s==null||s.reject(y)}})}async ready(t,n){var r,s;if(!this._connected)try{var c;typeof t=="function"&&(n=t,t={});let f=await this._caller.connectToParent(t);this._connected=!0,r=this._baseInfo,s=f,f=b()(r,s,{arrayMerge:(y,I)=>I}),this._baseInfo=f,(c=f)!==null&&c!==void 0&&c.id&&(this._debugTag=this._caller.debugTag=`#${f.id} [${f.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(f.settings=function(y,I){const B=(I||[]).reduce((G,q)=>("default"in q&&(G[q.key]=q.default),G),{});return Object.assign(B,y)}(f.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(y){console.warn(y)}n&&n.call(this,f)}catch(f){console.error(`${this._debugTag} [Ready Error]`,f)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(t){typeof t=="function"&&(this._beforeunloadCallback=t)}provideModel(t){return this.caller._extendUserModel(t),this}provideTheme(t){return this.caller.call("provider:theme",t),this}provideStyle(t){return this.caller.call("provider:style",t),this}provideUI(t){return this.caller.call("provider:ui",t),this}useSettingsSchema(t){return this.connected&&this.caller.call("settings:schema",{schema:t,isSync:!0}),this._settingsSchema=t,this}updateSettings(t){this.caller.call("settings:update",t)}onSettingsChanged(t){const n="settings:changed";return this.on(n,t),()=>this.off(n,t)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(t){this.caller.call("main-ui:attrs",t)}setMainUIInlineStyle(t){this.caller.call("main-ui:style",t)}hideMainUI(t){const n={key:0,visible:!1,cursor:t==null?void 0:t.restoreEditingCursor};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}showMainUI(t){const n={key:0,visible:!0,autoFocus:t==null?void 0:t.autoFocus};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}toggleMainUI(){const n=this._ui.get(0);n&&n.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const t=this._ui.get(0);return!!(t&&t.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(t=this)&&(((n=t.baseInfo)===null||n===void 0?void 0:n.effect)||!((r=t.baseInfo)!==null&&r!==void 0&&r.iir));var t,n,r}get logger(){return gr}get settings(){var t;return(t=this.baseInfo)===null||t===void 0?void 0:t.settings}get caller(){return this._caller}resolveResourceFullUrl(t){if(this.ensureConnected(),t)return t=t.replace(/^[.\\/]+/,""),E(this._baseInfo.lsr,t)}_makeUserProxy(t,n){const r=this,s=this.caller;return new Proxy(t,{get(c,f,y){const I=c[f];return function(...B){if(I){const q=I.apply(r,B.concat(n));if(q!==uo)return q}if(n){const q=f.toString().match(/^(once|off|on)/i);if(q!=null){const Q=q[0].toLowerCase(),lt=q.input,rt=Q==="off",mt=r.baseInfo.id;let gt=lt.slice(Q.length),jt=B[0],Ft=B[1];typeof jt=="string"&&typeof Ft=="function"&&(jt=jt.replace(/^logseq./,":"),gt=`${gt}${jt}`,jt=Ft,Ft=B[2]),gt=`hook:${n}:${F(gt)}`,s[Q](gt,jt);const Ce=()=>{s.off(gt,jt),s.listenerCount(gt)||r.App._uninstallPluginHook(mt,gt)};return rt?void Ce():(r.App._installPluginHook(mt,gt,Ft),Ce)}}let G=f;return["git","ui","assets"].includes(n)&&(G=n+"_"+G),s.callAsync("api:call",{tag:n,method:G,args:B})}}})}_execCallableAPIAsync(t,...n){return this._caller.callAsync("api:call",{method:t,args:n})}_execCallableAPI(t,...n){this._caller.call("api:call",{method:t,args:n})}_callWin(...t){return this._execCallableAPIAsync("_callMainWin",...t)}get App(){return this._makeUserProxy(ho,"app")}get Editor(){return this._makeUserProxy(po,"editor")}get DB(){return this._makeUserProxy(mo,"db")}get Git(){return this._makeUserProxy(go,"git")}get UI(){return this._makeUserProxy(yo,"ui")}get Assets(){return this._makeUserProxy(vo,"assets")}get FileStorage(){let t=this._mFileStorage;return t||(t=this._mFileStorage=new dt(this)),t}get Request(){let t=this._mRequest;return t||(t=this._mRequest=new $t(this)),t}get Experiments(){let t=this._mExperiments;return t||(t=this._mExperiments=new St(this)),t}}function br(e,t){return new Zn(e,t)}if(window.__LSP__HOST__==null){const e=new bt(null);window.logseq=br({},e)}})(),X})())})(Mn,Mn.exports);Mn.exports;var wr={exports:{}};(function(tt,it){(function(et,K){tt.exports=K()})(Wt,function(){var et=1e3,K=6e4,W=36e5,X="millisecond",h="second",u="minute",b="hour",M="day",C="week",D="month",nt="quarter",v="year",p="date",x="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(U){var A=["th","st","nd","rd"],O=U%100;return"["+U+(A[(O-20)%10]||A[O]||A[0])+"]"}},F=function(U,A,O){var P=String(U);return!P||P.length>=A?U:""+Array(A+1-P.length).join(O)+U},z={s:F,z:function(U){var A=-U.utcOffset(),O=Math.abs(A),P=Math.floor(O/60),H=O%60;return(A<=0?"+":"-")+F(P,2,"0")+":"+F(H,2,"0")},m:function U(A,O){if(A.date()<O.date())return-U(O,A);var P=12*(O.year()-A.year())+(O.month()-A.month()),H=A.clone().add(P,D),a=O-H<0,d=A.clone().add(P+(a?-1:1),D);return+(-(P+(O-H)/(a?H-d:d-H))||0)},a:function(U){return U<0?Math.ceil(U)||0:Math.floor(U)},p:function(U){return{M:D,y:v,w:C,d:M,D:p,h:b,m:u,s:h,ms:X,Q:nt}[U]||String(U||"").toLowerCase().replace(/s$/,"")},u:function(U){return U===void 0}},E="en",j={};j[E]=w;var i="$isDayjsObject",l=function(U){return U instanceof ct||!(!U||!U[i])},_=function U(A,O,P){var H;if(!A)return E;if(typeof A=="string"){var a=A.toLowerCase();j[a]&&(H=a),O&&(j[a]=O,H=a);var d=A.split("-");if(!H&&d.length>1)return U(d[0])}else{var k=A.name;j[k]=A,H=k}return!P&&H&&(E=H),H||!P&&E},g=function(U,A){if(l(U))return U.clone();var O=typeof A=="object"?A:{};return O.date=U,O.args=arguments,new ct(O)},Y=z;Y.l=_,Y.i=l,Y.w=function(U,A){return g(U,{locale:A.$L,utc:A.$u,x:A.$x,$offset:A.$offset})};var ct=function(){function U(O){this.$L=_(O.locale,null,!0),this.parse(O),this.$x=this.$x||O.x||{},this[i]=!0}var A=U.prototype;return A.parse=function(O){this.$d=function(P){var H=P.date,a=P.utc;if(H===null)return new Date(NaN);if(Y.u(H))return new Date;if(H instanceof Date)return new Date(H);if(typeof H=="string"&&!/Z$/i.test(H)){var d=H.match(m);if(d){var k=d[2]-1||0,J=(d[7]||"0").substring(0,3);return a?new Date(Date.UTC(d[1],k,d[3]||1,d[4]||0,d[5]||0,d[6]||0,J)):new Date(d[1],k,d[3]||1,d[4]||0,d[5]||0,d[6]||0,J)}}return new Date(H)}(O),this.init()},A.init=function(){var O=this.$d;this.$y=O.getFullYear(),this.$M=O.getMonth(),this.$D=O.getDate(),this.$W=O.getDay(),this.$H=O.getHours(),this.$m=O.getMinutes(),this.$s=O.getSeconds(),this.$ms=O.getMilliseconds()},A.$utils=function(){return Y},A.isValid=function(){return this.$d.toString()!==x},A.isSame=function(O,P){var H=g(O);return this.startOf(P)<=H&&H<=this.endOf(P)},A.isAfter=function(O,P){return g(O)<this.startOf(P)},A.isBefore=function(O,P){return this.endOf(P)<g(O)},A.$g=function(O,P,H){return Y.u(O)?this[P]:this.set(H,O)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(O,P){var H=this,a=!!Y.u(P)||P,d=Y.p(O),k=function(xt,bt){var ut=Y.w(H.$u?Date.UTC(H.$y,bt,xt):new Date(H.$y,bt,xt),H);return a?ut:ut.endOf(M)},J=function(xt,bt){return Y.w(H.toDate()[xt].apply(H.toDate("s"),(a?[0,0,0,0]:[23,59,59,999]).slice(bt)),H)},st=this.$W,T=this.$M,Z=this.$D,at="set"+(this.$u?"UTC":"");switch(d){case v:return a?k(1,0):k(31,11);case D:return a?k(1,T):k(0,T+1);case C:var vt=this.$locale().weekStart||0,_t=(st<vt?st+7:st)-vt;return k(a?Z-_t:Z+(6-_t),T);case M:case p:return J(at+"Hours",0);case b:return J(at+"Minutes",1);case u:return J(at+"Seconds",2);case h:return J(at+"Milliseconds",3);default:return this.clone()}},A.endOf=function(O){return this.startOf(O,!1)},A.$set=function(O,P){var H,a=Y.p(O),d="set"+(this.$u?"UTC":""),k=(H={},H[M]=d+"Date",H[p]=d+"Date",H[D]=d+"Month",H[v]=d+"FullYear",H[b]=d+"Hours",H[u]=d+"Minutes",H[h]=d+"Seconds",H[X]=d+"Milliseconds",H)[a],J=a===M?this.$D+(P-this.$W):P;if(a===D||a===v){var st=this.clone().set(p,1);st.$d[k](J),st.init(),this.$d=st.set(p,Math.min(this.$D,st.daysInMonth())).$d}else k&&this.$d[k](J);return this.init(),this},A.set=function(O,P){return this.clone().$set(O,P)},A.get=function(O){return this[Y.p(O)]()},A.add=function(O,P){var H,a=this;O=Number(O);var d=Y.p(P),k=function(T){var Z=g(a);return Y.w(Z.date(Z.date()+Math.round(T*O)),a)};if(d===D)return this.set(D,this.$M+O);if(d===v)return this.set(v,this.$y+O);if(d===M)return k(1);if(d===C)return k(7);var J=(H={},H[u]=K,H[b]=W,H[h]=et,H)[d]||1,st=this.$d.getTime()+O*J;return Y.w(st,this)},A.subtract=function(O,P){return this.add(-1*O,P)},A.format=function(O){var P=this,H=this.$locale();if(!this.isValid())return H.invalidDate||x;var a=O||"YYYY-MM-DDTHH:mm:ssZ",d=Y.z(this),k=this.$H,J=this.$m,st=this.$M,T=H.weekdays,Z=H.months,at=H.meridiem,vt=function(bt,ut,dt,St){return bt&&(bt[ut]||bt(P,a))||dt[ut].slice(0,St)},_t=function(bt){return Y.s(k%12||12,bt,"0")},xt=at||function(bt,ut,dt){var St=bt<12?"AM":"PM";return dt?St.toLowerCase():St};return a.replace(S,function(bt,ut){return ut||function(dt){switch(dt){case"YY":return String(P.$y).slice(-2);case"YYYY":return Y.s(P.$y,4,"0");case"M":return st+1;case"MM":return Y.s(st+1,2,"0");case"MMM":return vt(H.monthsShort,st,Z,3);case"MMMM":return vt(Z,st);case"D":return P.$D;case"DD":return Y.s(P.$D,2,"0");case"d":return String(P.$W);case"dd":return vt(H.weekdaysMin,P.$W,T,2);case"ddd":return vt(H.weekdaysShort,P.$W,T,3);case"dddd":return T[P.$W];case"H":return String(k);case"HH":return Y.s(k,2,"0");case"h":return _t(1);case"hh":return _t(2);case"a":return xt(k,J,!0);case"A":return xt(k,J,!1);case"m":return String(J);case"mm":return Y.s(J,2,"0");case"s":return String(P.$s);case"ss":return Y.s(P.$s,2,"0");case"SSS":return Y.s(P.$ms,3,"0");case"Z":return d}return null}(bt)||d.replace(":","")})},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(O,P,H){var a,d=this,k=Y.p(P),J=g(O),st=(J.utcOffset()-this.utcOffset())*K,T=this-J,Z=function(){return Y.m(d,J)};switch(k){case v:a=Z()/12;break;case D:a=Z();break;case nt:a=Z()/3;break;case C:a=(T-st)/6048e5;break;case M:a=(T-st)/864e5;break;case b:a=T/W;break;case u:a=T/K;break;case h:a=T/et;break;default:a=T}return H?a:Y.a(a)},A.daysInMonth=function(){return this.endOf(D).$D},A.$locale=function(){return j[this.$L]},A.locale=function(O,P){if(!O)return this.$L;var H=this.clone(),a=_(O,P,!0);return a&&(H.$L=a),H},A.clone=function(){return Y.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},U}(),ft=ct.prototype;return g.prototype=ft,[["$ms",X],["$s",h],["$m",u],["$H",b],["$W",M],["$M",D],["$y",v],["$D",p]].forEach(function(U){ft[U[1]]=function(A){return this.$g(A,U[0],U[1])}}),g.extend=function(U,A){return U.$i||(U(A,ct,g),U.$i=!0),g},g.locale=_,g.isDayjs=l,g.unix=function(U){return g(1e3*U)},g.en=j[E],g.Ls=j,g.p={},g})})(wr);var Ne=wr.exports;const Fe=Sn(Ne);var Mr={exports:{}};(function(tt,it){(function(et,K){tt.exports=K()})(Wt,function(){return function(et,K,W){et=et||{};var X=K.prototype,h={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function u(M,C,D,nt){return X.fromToBase(M,C,D,nt)}W.en.relativeTime=h,X.fromToBase=function(M,C,D,nt,v){for(var p,x,m,S=D.$locale().relativeTime||h,w=et.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],F=w.length,z=0;z<F;z+=1){var E=w[z];E.d&&(p=nt?W(M).diff(D,E.d,!0):D.diff(M,E.d,!0));var j=(et.rounding||Math.round)(Math.abs(p));if(m=p>0,j<=E.r||!E.r){j<=1&&z>0&&(E=w[z-1]);var i=S[E.l];v&&(j=v(""+j)),x=typeof i=="string"?i.replace("%d",j):i(j,C,E.l,m);break}}if(C)return x;var l=m?S.future:S.past;return typeof l=="function"?l(x):l.replace("%s",x)},X.to=function(M,C){return u(M,C,this,!0)},X.from=function(M,C){return u(M,C,this)};var b=function(M){return M.$u?W.utc():W()};X.toNow=function(M){return this.to(b(this),M)},X.fromNow=function(M){return this.from(b(this),M)}}})})(Mr);var _o=Mr.exports;const bo=Sn(_o);var wo={exports:{}};(function(tt,it){(function(et,K){tt.exports=K(Ne)})(Wt,function(et){function K(h){return h&&typeof h=="object"&&"default"in h?h:{default:h}}var W=K(et),X={name:"ja",weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(h){return h+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日(ddd) HH:mm"},meridiem:function(h){return h<12?"午前":"午後"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}};return W.default.locale(X,null,!0),X})})(wo);var xr={exports:{}};(function(tt,it){(function(et,K){tt.exports=K(Ne)})(Wt,function(et){function K(h){return h&&typeof h=="object"&&"default"in h?h:{default:h}}var W=K(et),X={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(h,u){return u==="W"?h+"周":h+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(h,u){var b=100*h+u;return b<600?"凌晨":b<900?"早上":b<1100?"上午":b<1300?"中午":b<1800?"下午":"晚上"}};return W.default.locale(X,null,!0),X})})(xr);var Mo=xr.exports;const xo=Sn(Mo);var So={exports:{}};(function(tt,it){(function(et,K){tt.exports=K(Ne)})(Wt,function(et){function K(h){return h&&typeof h=="object"&&"default"in h?h:{default:h}}var W=K(et),X={name:"zh-hk",months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),ordinal:function(h,u){return u==="W"?h+"週":h+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"一分鐘",mm:"%d 分鐘",h:"一小時",hh:"%d 小時",d:"一天",dd:"%d 天",M:"一個月",MM:"%d 個月",y:"一年",yy:"%d 年"}};return W.default.locale(X,null,!0),X})})(So);var Co={exports:{}};(function(tt,it){(function(et,K){tt.exports=K(Ne)})(Wt,function(et){function K(h){return h&&typeof h=="object"&&"default"in h?h:{default:h}}var W=K(et),X={name:"zh-tw",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(h,u){return u==="W"?h+"週":h+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"},meridiem:function(h,u){var b=100*h+u;return b<600?"凌晨":b<900?"早上":b<1100?"上午":b<1300?"中午":b<1800?"下午":"晚上"}};return W.default.locale(X,null,!0),X})})(Co);var Sr={exports:{}};(function(tt,it){(function(et,K){tt.exports=K(Ne)})(Wt,function(et){function K(h){return h&&typeof h=="object"&&"default"in h?h:{default:h}}var W=K(et),X={name:"zh",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(h,u){return u==="W"?h+"周":h+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s后",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(h,u){var b=100*h+u;return b<600?"凌晨":b<900?"早上":b<1100?"上午":b<1300?"中午":b<1800?"下午":"晚上"}};return W.default.locale(X,null,!0),X})})(Sr);var Oo=Sr.exports;const Eo=Sn(Oo),xn="today";xo[xn]="今天";Eo[xn]="今天";Fe.extend(bo);const jo=["do MMM yyyy","do MMMM yyyy","MMM do, yyyy","MMMM do, yyyy","E, dd-MM-yyyy","E, dd.MM.yyyy","E, MM/dd/yyyy","E, yyyy/MM/dd","EEE, dd-MM-yyyy","EEE, dd.MM.yyyy","EEE, MM/dd/yyyy","EEE, yyyy/MM/dd","EEEE, dd-MM-yyyy","EEEE, dd.MM.yyyy","EEEE, MM/dd/yyyy","EEEE, yyyy/MM/dd","dd-MM-yyyy","MM/dd/yyyy","MM-dd-yyyy","MM_dd_yyyy","yyyy/MM/dd","yyyy-MM-dd","yyyy-MM-dd EEEE","yyyy_MM_dd","yyyyMMdd","yyyy年MM月dd日"],Cr=new Map;(()=>{for(const tt of jo){let it=tt;it=it.replace(/E/g,""),it[0]===","&&(it=it.substring(1)),it=it.trim();const et=new RegExp(it.replace("yyyy","(?<year>\\d{4})").replace("dd","(?<day>\\d{1,2})").replace("do","(?<day>\\d{1,2})(?:st|nd|rd|th)").replace("MMMM","(?<month>janary|february|march|april|may|june|july|august|september|october|november|december)").replace("MMM","(?<month>jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)").replace("MM","(?<month>\\d{1,2})").replace(".","\\."),"i");Cr.set(tt,{contentRegex:et})}})();const ko={janary:1,february:2,march:3,april:4,may:5,june:6,july:7,august:8,september:9,october:10,november:11,december:12,jan:1,feb:2,mar:3,apr:4,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12};function Ao(tt,it){const et=Cr.get(it);if(et){const K=tt.match(et.contentRegex);if(K){const W=K.groups.month.toLowerCase(),X=ko[W]??parseInt(W);return new Date(parseInt(K.groups.year),X-1,parseInt(K.groups.day))}else console.debug(`Unable parse ${tt} with ${it}`)}else console.debug(`Not handled date format: ${it}`)}function To(tt,it){if(it){const et=Ao(tt,it);if(et)return et}}function Lo(tt,it){const et=Fe(it).startOf("day"),K=Fe(tt).startOf("day"),W=Fe.Ls[Fe.locale()];return K.isSame(et)?W[xn]||xn:K.from(et)}function Do(tt){return Lo(tt,new Date)}async function $o(){const tt=await logseq.App.getUserConfigs(),it=tt.preferredDateFormat;Fe.locale(tt.preferredLanguage);const et=[],K=[];function W(){for(const h of et.reverse())h();et.length=0}logseq.beforeunload(async()=>{W();for(const h of K.reverse())h==null||h();K.length=0});function X(h){return`
            <span class="date-between">${h}</span>
        `}logseq.provideStyle(`
        .date-between {
            border: 1px solid var(--ls-active-secondary-color);
            border-radius: 12px;
            padding: 0 0.4em 0 0.4em;
            font-size: 0.9em;
            color: var(--ls-active-secondary-color);
            line-height: initial;
        }
    `),K.push(logseq.App.onMacroRendererSlotted(async h=>{if(h.payload.arguments.length!==1||h.payload.arguments[0]!=="date-between-today")return;const u=await logseq.Editor.getBlock(h.payload.uuid);if(u){const b=To(u.content,it);if(b){let M=Do(b);logseq.provideUI({slot:h.slot,key:`date-between-${u.uuid}`,replace:!0,template:X(M)})}}})),K.push(logseq.Editor.registerSlashCommand("DateBetween: Date between today",async h=>{await logseq.Editor.insertAtEditingCursor("{{renderer date-between-today}}")}))}typeof logseq<"u"&&logseq.ready($o).catch(console.error);
