{{ if eq .osid "linux-debian" "linux-raspbian" "linux-ubuntu" -}}
#!/bin/bash

# Check if this is an extra user
if [ "{{ .extraUser }}" == "true" ]; then
  echo "Already installed by main user, skipping installation."
  exit 0
fi

{{ $packages := list
     "curl" -}}

{{ $fonts := list
     "fonts-firacode"
     "fonts-jetbrains-mono" -}}

{{ if not .ephemeral -}}
{{   $packages = concat $packages (list "i3" "keepassxc" "alacritty") -}}
{{ end -}}

{{ $sudo := "sudo " -}}
{{ if eq .chezmoi.username "root" -}}
{{   $sudo = "" -}}
{{ end -}}

{{ $sudo }}apt update
{{ $sudo }}apt install -y {{ $packages | join " " }} {{ $fonts | join " " }}



{{ if not .ephemeral }}

# Check if Proton VPN not already installed
# https://protonvpn.com/support/official-linux-vpn-debian/
if ! command -v protonvpn-app &> /dev/null; then
	echo "Proton VPN installation..."
	wget https://repo.protonvpn.com/debian/dists/stable/main/binary-all/protonvpn-stable-release_1.0.8_all.deb
	{{ $sudo }} dpkg -i ./protonvpn-stable-release_1.0.8_all.deb && {{ $sudo }} apt update
	echo "0b14e71586b22e498eb20926c48c7b434b751149b1f2af9902ef1cfe6b03e180 protonvpn-stable-release_1.0.8_all.deb" | sha256sum --check -
	{{ $sudo }}apt install proton-vpn-gnome-desktop
	{{ $sudo }}apt install libayatana-appindicator3-1 gir1.2-ayatanaappindicator3-0.1 gnome-shell-extension-appindicator
else
	echo "Proton Pass is already installed. Skipping installation."
fi

{{ end }}


{{ end -}}
