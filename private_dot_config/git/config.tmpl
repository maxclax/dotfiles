[user]
	name = {{ .gitName }}
	email = {{ .gitEmail }}
[includeIf "gitdir:{{ .workspace }}/**/.git"]
	name = {{ .gitGithub.name }}
	email = {{ .gitGithub.email }}
[color]
	ui = true
[diff]
	tool = emacs
[difftool "emacs"]
	cmd = emacs --eval "(ediff-files \"$LOCAL\" \"$REMOTE\")"
[difftool]
	prompt = false
[core]
	editor = emacs
	autocrlf = false
	hooksPath = ~/.config/git/hooks
[push]
	default = current
[init]
	defaultBranch = main
[merge]
  tool = emacs
  conflictstyle = diff3
[mergetool "emacs"]
	cmd = emacs --eval "(ediff-merge-files-with-ancestor \"$LOCAL\" \"$REMOTE\" \"$BASE\" nil \"$MERGED\")"
[mergetool]
  prompt = false
[credential]
	helper = cache
[color]
  ui = auto
[color "diff-highlight"]
  oldNormal = red
  oldHighlight = red "#500000"
  newNormal = green
  newHighlight = green "#003000"
[commit]
	template = ~/.config/git/commit
[color "diff"]
  meta = 11
  frag = magenta bold
  commit = yellow bold
  old = red
  new = green
  whitespace = "#ffff00" reverse
[alias]
  st = status
  so = remote show origin
  dh1 = diff HEAD~1
  head = !git r -1
  h = !git head
# Removed duplicate merge tool - using emacs above
[pull]
	ff = only
	rebase = false
[url "file:///"]
	insteadOf = file://
[protocol "file"]
	allow = always
[filter "lfs"]
	smudge = git-lfs smudge -- %f
	process = git-lfs filter-process
	required = true
	clean = git-lfs clean -- %f

# GitHub https authentication
{{- if lookPath "gh" }}
[credential "https://github.com"]
  helper = !{{ output "which" "gh" | trim }} auth git-credential
[credential "https://gist.github.com"]
  helper = !{{ output "which" "gh" | trim }} auth git-credential
{{- end }}

{{ if .gitGithub.gpgsign.enabled }}
[user]
  signingkey = {{ .gitGithub.gpgsign.signingKey }}
[gpg]
  format = ssh
[gpg "ssh"]
  program = {{ .gitGithub.gpgsign.program | quote }}
[commit]
  gpgsign = true
{{ end }}
