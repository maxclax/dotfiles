source_directories:
  - {{ .workspace | quote }}

repositories:
  - path: {{ .borgRepository | quote }}
    
exclude_patterns:
  - '*/.data/*'
  - '*/backup/*'
  - '*/node_modules/*'
  - '*/.venv/*'
  - '*/.pnpm-store/*'
  - '*/.pytest_cache/*'
  - '*/.terraform/*'
  - '__pycache__'
  - '*/.cache/*'
  - '*/.mypy_cache/*'
  - '*/.tox/*'
  - '*/.DS_Store'

encryption_passcommand: op read "op://Private/chezmoi-data/borg-encryption-passphrase"
compression: 'lz4'
archive_name_format: "workspace-{now:%Y-%m-%d-%H%M%S}"

# Retention settings
keep_daily: 7
keep_weekly: 2   
keep_monthly: 3

# Healthchecks
checks:
  - name: repository
    frequency: 2 weeks  # Regular repository checks
  - name: archives
    frequency: 3 days   # More frequent archive checks

# Performance and resource settings
lock_wait: 300  
files_cache: "size,mtime,inode"
read_special: true
one_file_system: false

# Error handling
retries: 3
retry_wait: 60
