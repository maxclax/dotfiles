# -*- mode: nix; -*-
{ pkgs, ... }:

{
  # Install espanso package
  home.packages = with pkgs; [
    espanso  # Text expander
  ];

  # Configure espanso as a user service using launchd on macOS
{{- if eq .chezmoi.os "darwin" }}
  launchd.agents.espanso = {
    enable = true;
    config = {
      ProgramArguments = [
        "${pkgs.espanso}/bin/espanso"
        "service"
        "start"
        "--unmanaged"
      ];
      RunAtLoad = true;
      KeepAlive = true;
      StandardOutPath = "{{ .chezmoi.homeDir }}/Library/Logs/espanso.log";
      StandardErrorPath = "{{ .chezmoi.homeDir }}/Library/Logs/espanso.log";
    };
  };
{{- end }}
}